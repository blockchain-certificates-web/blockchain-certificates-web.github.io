import{g as e,u as t,k as n,t as o}from"./main.js";var r,a,i={};function s(){return a?r:(a=1,r=class e{constructor(e,t=new Map,n=0){this.prefix=e,this._existing=t,this.counter=n}clone(){const{prefix:t,_existing:n,counter:o}=this;return new e(t,new Map(n),o)}getId(e){const t=e&&this._existing.get(e);if(t)return t;const n=this.prefix+this.counter;return this.counter++,e&&this._existing.set(e,n),n}hasId(e){return this._existing.has(e)}getOldIds(){return[...this._existing.keys()]}})}var l,c,d,u,p,f,h,v,g,y,m,x,b,w,j,I={};function N(){return l||(l=1,function(e){if(!e.setImmediate){var t,n,r,a,i,s=1,l={},c=!1,d=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?t=function(e){o((function(){f(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){f(e.data)},t=function(e){r.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(n=d.documentElement,t=function(e){var t=d.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):t=function(e){setTimeout(f,0,e)}:(a="setImmediate$"+Math.random()+"$",i=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&f(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",i,!1):e.attachEvent("onmessage",i),t=function(t){e.postMessage(a+t,"*")}),u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var n=new Array(arguments.length-1),o=0;o<n.length;o++)n[o]=arguments[o+1];var r={callback:e,args:n};return l[s]=r,t(s),s++},u.clearImmediate=p}function p(e){delete l[e]}function f(e){if(c)setTimeout(f,0,e);else{var t=l[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{p(e),c=!1}}}}}("undefined"==typeof self?void 0===n?I:n:self)),I}
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */function S(){if(d)return c;d=1,N();const e=self.crypto||self.msCrypto;return c=class{constructor(t){if(!e||!e.subtle)throw new Error("crypto.subtle not found.");if("sha256"===t)this.algorithm={name:"SHA-256"};else{if("sha1"!==t)throw new Error(`Unsupported algorithm "${t}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(e){this._content+=e}async digest(){const t=(new TextEncoder).encode(this._content),n=new Uint8Array(await e.subtle.digest(this.algorithm,t));let o="";for(let e=0;e<n.length;++e)o+=n[e].toString(16).padStart(2,"0");return o}}}
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */function O(){return p?u:(p=1,u=class{constructor(e){this.current=e.sort(),this.done=!1,this.dir=new Map;for(let t=0;t<e.length;++t)this.dir.set(e[t],!0)}hasNext(){return!this.done}next(){const{current:e,dir:t}=this,n=e.slice();let o=null,r=0;const a=e.length;for(let n=0;n<a;++n){const i=e[n],s=t.get(i);(null===o||i>o)&&(s&&n>0&&i>e[n-1]||!s&&n<a-1&&i>e[n+1])&&(o=i,r=n)}if(null===o)this.done=!0;else{const n=t.get(o)?r-1:r+1;e[r]=e[n],e[n]=o;for(const n of e)n>o&&t.set(n,!t.get(n))}return n}})}
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */function E(){if(h)return f;h=1;const e="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",t="http://www.w3.org/2001/XMLSchema#string",n="NamedNode",o="BlankNode",r="Literal",a="DefaultGraph",i={};function s(e,t){return e.subject.termType===t.subject.termType&&e.object.termType===t.object.termType&&(e.subject.value===t.subject.value&&e.predicate.value===t.predicate.value&&e.object.value===t.object.value&&(e.object.termType!==r||e.object.datatype.termType===t.object.datatype.termType&&e.object.language===t.object.language&&e.object.datatype.value===t.object.datatype.value))}(()=>{const e="(?:<([^:]+:[^>]*)>)",t="A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_",n=t+"0-9-·̀-ͯ‿-⁀",o="(_:(?:["+t+"0-9])(?:(?:["+n+".])*(?:["+n+"]))?)",r="[ \\t]+",a="[ \\t]*",s="(?:"+e+"|"+o+")"+r,l=e+r,c="(?:"+e+"|"+o+"|"+('(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:'+("(?:\\^\\^"+e+")")+"|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?)")+")"+a,d="(?:\\.|(?:(?:"+e+"|"+o+")"+a+"\\.))";i.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,i.empty=new RegExp("^"+a+"$"),i.quad=new RegExp("^"+a+s+l+c+d+a+"$")})(),f=class d{static parse(l){const d=[],u={},p=l.split(i.eoln);let f=0;for(const l of p){if(f++,i.empty.test(l))continue;const p=l.match(i.quad);if(null===p)throw new Error("N-Quads parse error on line "+f+".");const h={subject:null,predicate:null,object:null,graph:null};if(void 0!==p[1]?h.subject={termType:n,value:p[1]}:h.subject={termType:o,value:p[2]},h.predicate={termType:n,value:p[3]},void 0!==p[4]?h.object={termType:n,value:p[4]}:void 0!==p[5]?h.object={termType:o,value:p[5]}:(h.object={termType:r,value:void 0,datatype:{termType:n}},void 0!==p[7]?h.object.datatype.value=p[7]:void 0!==p[8]?(h.object.datatype.value=e,h.object.language=p[8]):h.object.datatype.value=t,h.object.value=p[6].replace(c,(function(e,t,n,o){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(n)return String.fromCharCode(parseInt(n,16));if(o)throw new Error("Unsupported U escape")}))),void 0!==p[9]?h.graph={termType:n,value:p[9]}:void 0!==p[10]?h.graph={termType:o,value:p[10]}:h.graph={termType:a,value:""},h.graph.value in u){let e=!0;const t=u[h.graph.value];for(const n of t)if(s(n,h)){e=!1;break}e&&(t.push(h),d.push(h))}else u[h.graph.value]=[h],d.push(h)}return d}static serialize(e){Array.isArray(e)||(e=d.legacyDatasetToQuads(e));const t=[];for(const n of e)t.push(d.serializeQuad(n));return t.sort().join("")}static serializeQuadComponents(r,a,i,s){let c="";return r.termType===n?c+=`<${r.value}>`:c+=`${r.value}`,c+=` <${a.value}> `,i.termType===n?c+=`<${i.value}>`:i.termType===o?c+=i.value:(c+=`"${function(e){return e.replace(l,(function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}}))}(i.value)}"`,i.datatype.value===e?i.language&&(c+=`@${i.language}`):i.datatype.value!==t&&(c+=`^^<${i.datatype.value}>`)),s.termType===n?c+=` <${s.value}>`:s.termType===o&&(c+=` ${s.value}`),c+=" .\n",c}static serializeQuad(e){return d.serializeQuadComponents(e.subject,e.predicate,e.object,e.graph)}static legacyDatasetToQuads(i){const s=[],l={"blank node":o,IRI:n,literal:r};for(const c in i){i[c].forEach((i=>{const d={};for(const o in i){const a=i[o],s={termType:l[a.type],value:a.value};s.termType===r&&(s.datatype={termType:n},"datatype"in a&&(s.datatype.value=a.datatype),"language"in a?("datatype"in a||(s.datatype.value=e),s.language=a.language):"datatype"in a||(s.datatype.value=t)),d[o]=s}d.graph="@default"===c?{termType:a,value:""}:{termType:c.startsWith("_:")?o:n,value:c},s.push(d)}))}return s}};const l=/["\\\n\r]/g;const c=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g;return f}
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */function D(){if(g)return v;g=1;const e=s(),t=S(),n=O(),o=E();function r(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}return v=class{constructor({createMessageDigest:n=()=>new t("sha256"),canonicalIdMap:o=new Map,maxDeepIterations:r=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new e("_:c14n",o),this.createMessageDigest=n,this.maxDeepIterations=r,this.quads=null,this.deepIterations=null}async main(t){this.deepIterations=new Map,this.quads=t;for(const e of t)this._addBlankNodeQuadInfo({quad:e,component:e.subject}),this._addBlankNodeQuadInfo({quad:e,component:e.object}),this._addBlankNodeQuadInfo({quad:e,component:e.graph});const n=new Map,a=[...this.blankNodeInfo.keys()];let i=0;for(const e of a)++i%100==0&&await this._yield(),await this._hashAndTrackBlankNode({id:e,hashToBlankNodes:n});const s=[...n.keys()].sort(),l=[];for(const e of s){const t=n.get(e);if(t.length>1){l.push(t);continue}const o=t[0];this.canonicalIssuer.getId(o)}for(const t of l){const n=[];for(const o of t){if(this.canonicalIssuer.hasId(o))continue;const t=new e("_:b");t.getId(o);const r=await this.hashNDegreeQuads(o,t);n.push(r)}n.sort(r);for(const e of n){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const c=[];for(const e of this.quads){const t=o.serializeQuadComponents(this._componentWithCanonicalId(e.subject),e.predicate,this._componentWithCanonicalId(e.object),this._componentWithCanonicalId(e.graph));c.push(t)}return c.sort(),c.join("")}async hashFirstDegreeQuads(e){const t=[],n=this.blankNodeInfo.get(e),r=n.quads;for(const n of r){const r={subject:null,predicate:n.predicate,object:null,graph:null};r.subject=this.modifyFirstDegreeComponent(e,n.subject,"subject"),r.object=this.modifyFirstDegreeComponent(e,n.object,"object"),r.graph=this.modifyFirstDegreeComponent(e,n.graph,"graph"),t.push(o.serializeQuad(r))}t.sort();const a=this.createMessageDigest();for(const e of t)a.update(e);return n.hash=await a.digest(),n.hash}async hashRelatedBlankNode(e,t,n,o){let r;r=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):this.blankNodeInfo.get(e).hash;const a=this.createMessageDigest();return a.update(o),"g"!==o&&a.update(this.getRelatedPredicate(t)),a.update(r),a.digest()}async hashNDegreeQuads(e,t){const o=this.deepIterations.get(e)||0;if(o>this.maxDeepIterations)throw new Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(e,o+1);const r=this.createMessageDigest(),a=await this.createHashToRelated(e,t),i=[...a.keys()].sort();for(const e of i){r.update(e);let o,i="";const s=new n(a.get(e));let l=0;for(;s.hasNext();){const e=s.next();++l%3==0&&await this._yield();let n=t.clone(),r="";const a=[];let c=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?r+=this.canonicalIssuer.getId(t):(n.hasId(t)||a.push(t),r+=n.getId(t)),0!==i.length&&r>i){c=!0;break}if(!c){for(const e of a){const t=await this.hashNDegreeQuads(e,n);if(r+=n.getId(e),r+=`<${t.hash}>`,n=t.issuer,0!==i.length&&r>i){c=!0;break}}c||(0===i.length||r<i)&&(i=r,o=n)}}r.update(i),t=o}return{hash:await r.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}async createHashToRelated(e,t){const n=new Map,o=this.blankNodeInfo.get(e).quads;let r=0;for(const a of o)++r%100==0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:a,component:a.subject,position:"s",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:a,component:a.object,position:"o",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:a,component:a.graph,position:"g",id:e,issuer:t,hashToRelated:n})]);return n}async _hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const n=await this.hashFirstDegreeQuads(e),o=t.get(n);o?o.push(e):t.set(n,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const n=t.value,o=this.blankNodeInfo.get(n);o?o.quads.add(e):this.blankNodeInfo.set(n,{quads:new Set([e]),hash:null})}async _addRelatedBlankNodeHash({quad:e,component:t,position:n,id:o,issuer:r,hashToRelated:a}){if("BlankNode"!==t.termType||t.value===o)return;const i=t.value,s=await this.hashRelatedBlankNode(i,e,r,n),l=a.get(s);l?l.push(i):a.set(s,[i])}_componentWithCanonicalId(e){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}async _yield(){return new Promise((e=>setImmediate(e)))}}}
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */function k(){if(m)return y;m=1;const e=S(),t=D();return y=class extends t{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new e("sha1")}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}async createHashToRelated(e,t){const n=new Map,o=this.blankNodeInfo.get(e).quads;let r=0;for(const a of o){let o,i;if("BlankNode"===a.subject.termType&&a.subject.value!==e)i=a.subject.value,o="p";else{if("BlankNode"!==a.object.termType||a.object.value===e)continue;i=a.object.value,o="r"}++r%100==0&&await this._yield();const s=await this.hashRelatedBlankNode(i,a,t,o),l=n.get(s);l?l.push(i):n.set(s,[i])}return n}}}
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */function C(){if(b)return x;b=1;const e=s(),t=S(),n=O(),o=E();function r(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}return x=class{constructor({createMessageDigest:n=()=>new t("sha256"),canonicalIdMap:o=new Map,maxDeepIterations:r=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new e("_:c14n",o),this.createMessageDigest=n,this.maxDeepIterations=r,this.quads=null,this.deepIterations=null}main(t){this.deepIterations=new Map,this.quads=t;for(const e of t)this._addBlankNodeQuadInfo({quad:e,component:e.subject}),this._addBlankNodeQuadInfo({quad:e,component:e.object}),this._addBlankNodeQuadInfo({quad:e,component:e.graph});const n=new Map,a=[...this.blankNodeInfo.keys()];for(const e of a)this._hashAndTrackBlankNode({id:e,hashToBlankNodes:n});const i=[...n.keys()].sort(),s=[];for(const e of i){const t=n.get(e);if(t.length>1){s.push(t);continue}const o=t[0];this.canonicalIssuer.getId(o)}for(const t of s){const n=[];for(const o of t){if(this.canonicalIssuer.hasId(o))continue;const t=new e("_:b");t.getId(o);const r=this.hashNDegreeQuads(o,t);n.push(r)}n.sort(r);for(const e of n){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const l=[];for(const e of this.quads){const t=o.serializeQuadComponents(this._componentWithCanonicalId({component:e.subject}),e.predicate,this._componentWithCanonicalId({component:e.object}),this._componentWithCanonicalId({component:e.graph}));l.push(t)}return l.sort(),l.join("")}hashFirstDegreeQuads(e){const t=[],n=this.blankNodeInfo.get(e),r=n.quads;for(const n of r){const r={subject:null,predicate:n.predicate,object:null,graph:null};r.subject=this.modifyFirstDegreeComponent(e,n.subject,"subject"),r.object=this.modifyFirstDegreeComponent(e,n.object,"object"),r.graph=this.modifyFirstDegreeComponent(e,n.graph,"graph"),t.push(o.serializeQuad(r))}t.sort();const a=this.createMessageDigest();for(const e of t)a.update(e);return n.hash=a.digest(),n.hash}hashRelatedBlankNode(e,t,n,o){let r;r=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):this.blankNodeInfo.get(e).hash;const a=this.createMessageDigest();return a.update(o),"g"!==o&&a.update(this.getRelatedPredicate(t)),a.update(r),a.digest()}hashNDegreeQuads(e,t){const o=this.deepIterations.get(e)||0;if(o>this.maxDeepIterations)throw new Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(e,o+1);const r=this.createMessageDigest(),a=this.createHashToRelated(e,t),i=[...a.keys()].sort();for(const e of i){r.update(e);let o,i="";const s=new n(a.get(e));for(;s.hasNext();){const e=s.next();let n=t.clone(),r="";const a=[];let l=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?r+=this.canonicalIssuer.getId(t):(n.hasId(t)||a.push(t),r+=n.getId(t)),0!==i.length&&r>i){l=!0;break}if(!l){for(const e of a){const t=this.hashNDegreeQuads(e,n);if(r+=n.getId(e),r+=`<${t.hash}>`,n=t.issuer,0!==i.length&&r>i){l=!0;break}}l||(0===i.length||r<i)&&(i=r,o=n)}}r.update(i),t=o}return{hash:r.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}createHashToRelated(e,t){const n=new Map,o=this.blankNodeInfo.get(e).quads;for(const r of o)this._addRelatedBlankNodeHash({quad:r,component:r.subject,position:"s",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:r,component:r.object,position:"o",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:r,component:r.graph,position:"g",id:e,issuer:t,hashToRelated:n});return n}_hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const n=this.hashFirstDegreeQuads(e),o=t.get(n);o?o.push(e):t.set(n,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const n=t.value,o=this.blankNodeInfo.get(n);o?o.quads.add(e):this.blankNodeInfo.set(n,{quads:new Set([e]),hash:null})}_addRelatedBlankNodeHash({quad:e,component:t,position:n,id:o,issuer:r,hashToRelated:a}){if("BlankNode"!==t.termType||t.value===o)return;const i=t.value,s=this.hashRelatedBlankNode(i,e,r,n),l=a.get(s);l?l.push(i):a.set(s,[i])}_componentWithCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}}}
/*!
 * Copyright (c) 2016-2021 Digital Bazaar, Inc. All rights reserved.
 */function L(){if(j)return w;j=1;const e=S(),t=C();return w=class extends t{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new e("sha1")}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const n=new Map,o=this.blankNodeInfo.get(e).quads;for(const r of o){let o,a;if("BlankNode"===r.subject.termType&&r.subject.value!==e)a=r.subject.value,o="p";else{if("BlankNode"!==r.object.termType||r.object.value===e)continue;a=r.object.value,o="r"}const i=this.hashRelatedBlankNode(a,r,t,o),s=n.get(i);s?s.push(a):n.set(i,[a])}return n}}}var R,T,A,_,M,J,P,B,H,F,q,U,V,z,G,$,Q,X,W,K,Z,Y,ee,te,ne,oe,re,ae,ie,se,le,ce,de,ue,pe,fe,he,ve,ge,ye,me,xe,be,we,je,Ie,Ne,Se,Oe,Ee,De,ke,Ce,Le,Re,Te,Ae,_e=t(Object.freeze({__proto__:null,default:{}}));function Me(){return A?T:(A=1,R||(R=1,function(e){const t=D(),n=k(),o=C(),r=L();let a;try{a=_e}catch(e){}function i(t){return Array.isArray(t)?t:e.NQuads.legacyDatasetToQuads(t)}e.NQuads=E(),e.IdentifierIssuer=s(),e._rdfCanonizeNative=function(e){return e&&(a=e),a},e.canonize=async function(e,o){const r=i(e);if(o.useNative){if(!a)throw new Error("rdf-canonize-native not available");if(o.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return new Promise(((e,t)=>a.canonize(r,o,((n,o)=>n?t(n):e(o)))))}if("URDNA2015"===o.algorithm)return new t(o).main(r);if("URGNA2012"===o.algorithm){if(o.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new n(o).main(r)}if(!("algorithm"in o))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+o.algorithm)},e._canonizeSync=function(e,t){const n=i(e);if(t.useNative){if(!a)throw new Error("rdf-canonize-native not available");if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return a.canonizeSync(n,t)}if("URDNA2015"===t.algorithm)return new o(t).main(n);if("URGNA2012"===t.algorithm){if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new r(t).main(n)}if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)}}(i)),T=i)}function Je(){if(M)return _;M=1;const e={};return _=e,e.isArray=Array.isArray,e.isBoolean=e=>"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e),e.isDouble=t=>e.isNumber(t)&&(-1!==String(t).indexOf(".")||Math.abs(t)>=1e21),e.isEmptyObject=t=>e.isObject(t)&&0===Object.keys(t).length,e.isNumber=e=>"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e),e.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e),e.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),e.isString=e=>"string"==typeof e||"[object String]"===Object.prototype.toString.call(e),e.isUndefined=e=>void 0===e,_}function Pe(){if(P)return J;P=1;const e=Je(),t={};return J=t,t.isSubject=t=>{if(e.isObject(t)&&!("@value"in t||"@set"in t||"@list"in t)){return Object.keys(t).length>1||!("@id"in t)}return!1},t.isSubjectReference=t=>e.isObject(t)&&1===Object.keys(t).length&&"@id"in t,t.isValue=t=>e.isObject(t)&&"@value"in t,t.isList=t=>e.isObject(t)&&"@list"in t,t.isGraph=t=>e.isObject(t)&&"@graph"in t&&1===Object.keys(t).filter((e=>"@id"!==e&&"@index"!==e)).length,t.isSimpleGraph=e=>t.isGraph(e)&&!("@id"in e),t.isBlankNode=t=>{if(e.isObject(t)){if("@id"in t){const n=t["@id"];return!e.isString(n)||0===n.indexOf("_:")}return 0===Object.keys(t).length||!("@value"in t||"@set"in t||"@list"in t)}return!1},J}function Be(){return H?B:(H=1,B=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",t="jsonld.Error",n={}){super(e),this.name=t,this.message=e,this.details=n}})}function He(){if(q)return F;q=1;const e=Pe(),t=Je(),n=Me().IdentifierIssuer,o=Be(),r=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,a=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,i=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,s={accept:"application/ld+json, application/json"},l={};function c(n,o){if(t.isArray(o))for(let e=0;e<o.length;++e)o[e]=c(n,o[e]);else if(e.isList(o))o["@list"]=c(n,o["@list"]);else if(t.isObject(o)){e.isBlankNode(o)&&(o["@id"]=n.getId(o["@id"]));const t=Object.keys(o).sort();for(let e=0;e<t.length;++e){const r=t[e];"@id"!==r&&(o[r]=c(n,o[r]))}}return o}return F=l,l.IdentifierIssuer=n,l.REGEX_BCP47=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,l.REGEX_KEYWORD=/^@[a-zA-Z]+$/,l.clone=function(e){if(e&&"object"==typeof e){let n;if(t.isArray(e)){n=[];for(let t=0;t<e.length;++t)n[t]=l.clone(e[t])}else if(e instanceof Map){n=new Map;for(const[t,o]of e)n.set(t,l.clone(o))}else if(e instanceof Set){n=new Set;for(const t of e)n.add(l.clone(t))}else if(t.isObject(e)){n={};for(const t in e)n[t]=l.clone(e[t])}else n=e.toString();return n}return e},l.asArray=function(e){return Array.isArray(e)?e:[e]},l.buildHeaders=(e={})=>{if(Object.keys(e).some((e=>"accept"===e.toLowerCase())))throw new RangeError('Accept header may not be specified; only "'+s.accept+'" is supported.');return Object.assign({Accept:s.accept},e)},l.parseLinkHeader=e=>{const t={},n=e.match(r);for(let e=0;e<n.length;++e){let o=n[e].match(a);if(!o)continue;const r={target:o[1]},s=o[2];for(;o=i.exec(s);)r[o[1]]=void 0===o[2]?o[3]:o[2];const l=r.rel||"";Array.isArray(t[l])?t[l].push(r):t.hasOwnProperty(l)?t[l]=[t[l],r]:t[l]=r}return t},l.validateTypeValue=(e,n)=>{if(!(t.isString(e)||t.isArray(e)&&e.every((e=>t.isString(e))))){if(n&&t.isObject(e))switch(Object.keys(e).length){case 0:return;case 1:if("@default"in e&&l.asArray(e["@default"]).every((e=>t.isString(e))))return}throw new o('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}},l.hasProperty=(e,n)=>{if(e.hasOwnProperty(n)){const o=e[n];return!t.isArray(o)||o.length>0}return!1},l.hasValue=(n,o,r)=>{if(l.hasProperty(n,o)){let a=n[o];const i=e.isList(a);if(t.isArray(a)||i){i&&(a=a["@list"]);for(let e=0;e<a.length;++e)if(l.compareValues(r,a[e]))return!0}else if(!t.isArray(r))return l.compareValues(r,a)}return!1},l.addValue=(e,n,o,r)=>{if("propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1),"valueIsArray"in r||(r.valueIsArray=!1),"allowDuplicate"in r||(r.allowDuplicate=!0),"prependValue"in r||(r.prependValue=!1),r.valueIsArray)e[n]=o;else if(t.isArray(o)){0===o.length&&r.propertyIsArray&&!e.hasOwnProperty(n)&&(e[n]=[]),r.prependValue&&(o=o.concat(e[n]),e[n]=[]);for(let t=0;t<o.length;++t)l.addValue(e,n,o[t],r)}else if(e.hasOwnProperty(n)){const a=!r.allowDuplicate&&l.hasValue(e,n,o);t.isArray(e[n])||a&&!r.propertyIsArray||(e[n]=[e[n]]),a||(r.prependValue?e[n].unshift(o):e[n].push(o))}else e[n]=r.propertyIsArray?[o]:o},l.getValues=(e,t)=>[].concat(e[t]||[]),l.removeProperty=(e,t)=>{delete e[t]},l.removeValue=(e,t,n,o)=>{"propertyIsArray"in(o=o||{})||(o.propertyIsArray=!1);const r=l.getValues(e,t).filter((e=>!l.compareValues(e,n)));0===r.length?l.removeProperty(e,t):1!==r.length||o.propertyIsArray?e[t]=r:e[t]=r[0]},l.relabelBlankNodes=(e,t)=>c((t=t||{}).issuer||new n("_:b"),e),l.compareValues=(n,o)=>n===o||(!(!e.isValue(n)||!e.isValue(o)||n["@value"]!==o["@value"]||n["@type"]!==o["@type"]||n["@language"]!==o["@language"]||n["@index"]!==o["@index"])||!!(t.isObject(n)&&"@id"in n&&t.isObject(o)&&"@id"in o)&&n["@id"]===o["@id"]),l.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1,F}function Fe(){if(V)return U;V=1;const e="http://www.w3.org/1999/02/22-rdf-syntax-ns#",t="http://www.w3.org/2001/XMLSchema#";return U={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:e,RDF_LIST:e+"List",RDF_FIRST:e+"first",RDF_REST:e+"rest",RDF_NIL:e+"nil",RDF_TYPE:e+"type",RDF_PLAIN_LITERAL:e+"PlainLiteral",RDF_XML_LITERAL:e+"XMLLiteral",RDF_JSON_LITERAL:e+"JSON",RDF_OBJECT:e+"object",RDF_LANGSTRING:e+"langString",XSD:t,XSD_BOOLEAN:t+"boolean",XSD_DOUBLE:t+"double",XSD_INTEGER:t+"integer",XSD_STRING:t+"string"}}function qe(){return G||(G=1,z=class{constructor(){this._requests={}}wrapLoader(e){const t=this;return t._loader=e,function(){return t.add.apply(t,arguments)}}async add(e){let t=this._requests[e];if(t)return Promise.resolve(t);t=this._requests[e]=this._loader(e);try{return await t}finally{delete this._requests[e]}}}),z}function Ue(){if(Q)return $;Q=1;const e=Je(),t={};$=t,t.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([a-zA-Z][a-zA-Z0-9+-.]*):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},t.parse=(e,n)=>{const o={},r=t.parsers[n||"full"],a=r.regex.exec(e);let i=r.keys.length;for(;i--;)o[r.keys[i]]=void 0===a[i]?null:a[i];return("https"===o.scheme&&"443"===o.port||"http"===o.scheme&&"80"===o.port)&&(o.href=o.href.replace(":"+o.port,""),o.authority=o.authority.replace(":"+o.port,""),o.port=null),o.normalizedPath=t.removeDotSegments(o.path),o},t.prependBase=(n,o)=>{if(null===n)return o;if(t.isAbsolute(o))return o;n&&!e.isString(n)||(n=t.parse(n||""));const r=t.parse(o),a={protocol:n.protocol||""};if(null!==r.authority)a.authority=r.authority,a.path=r.path,a.query=r.query;else if(a.authority=n.authority,""===r.path)a.path=n.path,null!==r.query?a.query=r.query:a.query=n.query;else{if(0===r.path.indexOf("/"))a.path=r.path;else{let e=n.path;e=e.substr(0,e.lastIndexOf("/")+1),(e.length>0||n.authority)&&"/"!==e.substr(-1)&&(e+="/"),e+=r.path,a.path=e}a.query=r.query}""!==r.path&&(a.path=t.removeDotSegments(a.path));let i=a.protocol;return null!==a.authority&&(i+="//"+a.authority),i+=a.path,null!==a.query&&(i+="?"+a.query),null!==r.fragment&&(i+="#"+r.fragment),""===i&&(i="./"),i},t.removeBase=(n,o)=>{if(null===n)return o;n&&!e.isString(n)||(n=t.parse(n||""));let r="";if(""!==n.href?r+=(n.protocol||"")+"//"+(n.authority||""):o.indexOf("//")&&(r+="//"),0!==o.indexOf(r))return o;const a=t.parse(o.substr(r.length)),i=n.normalizedPath.split("/"),s=a.normalizedPath.split("/"),l=a.fragment||a.query?0:1;for(;i.length>0&&s.length>l&&i[0]===s[0];)i.shift(),s.shift();let c="";if(i.length>0){i.pop();for(let e=0;e<i.length;++e)c+="../"}return c+=s.join("/"),null!==a.query&&(c+="?"+a.query),null!==a.fragment&&(c+="#"+a.fragment),""===c&&(c="./"),c},t.removeDotSegments=e=>{if(0===e.length)return"";const t=e.split("/"),n=[];for(;t.length>0;){const e=t.shift(),o=0===t.length;"."!==e?".."!==e?n.push(e):(n.pop(),o&&n.push("")):o&&n.push("")}return"/"===e[0]&&n.length>0&&""!==n[0]&&n.unshift(""),1===n.length&&""===n[0]?"/":n.join("/")};const n=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;return t.isAbsolute=t=>e.isString(t)&&n.test(t),t.isRelative=t=>e.isString(t),$}function Ve(){if(W)return X;W=1;const{parseLinkHeader:e,buildHeaders:t}=He(),{LINK_HEADER_CONTEXT:n}=Fe(),o=Be(),r=qe(),{prependBase:a}=Ue(),i=/(^|(\r\n))link:/i;return X=({secure:s,headers:l={},xhr:c}={headers:{}})=>{l=t(l);return(new r).wrapLoader((async function t(r){if(0!==r.indexOf("http:")&&0!==r.indexOf("https:"))throw new o('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:r});if(s&&0!==r.indexOf("https"))throw new o('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:r});let d;try{d=await function(e,t,n){e=e||XMLHttpRequest;const o=new e;return new Promise(((e,r)=>{o.onload=()=>e(o),o.onerror=e=>r(e),o.open("GET",t,!0);for(const e in n)o.setRequestHeader(e,n[e]);o.send()}))}(c,r,l)}catch(e){throw new o("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:r,cause:e})}if(d.status>=400)throw new o("URL could not be dereferenced: "+d.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:r,httpStatusCode:d.status});let u={contextUrl:null,documentUrl:r,document:d.response},p=null;const f=d.getResponseHeader("Content-Type");let h;i.test(d.getAllResponseHeaders())&&(h=d.getResponseHeader("Link"));if(h&&"application/ld+json"!==f){const i=e(h),s=i[n];if(Array.isArray(s))throw new o("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:r});s&&(u.contextUrl=s.target),p=i.alternate,p&&"application/ld+json"==p.type&&!(f||"").match(/^application\/(\w*\+)?json$/)&&(u=await t(a(r,p.target)))}return u}))},X}function ze(){if(ne)return te;function e(t){var n=this;if(n instanceof e||(n=new e),n.tail=null,n.head=null,n.length=0,t&&"function"==typeof t.forEach)t.forEach((function(e){n.push(e)}));else if(arguments.length>0)for(var o=0,r=arguments.length;o<r;o++)n.push(arguments[o]);return n}function t(e,t,n){var o=t===e.head?new r(n,null,t,e):new r(n,t,t.next,e);return null===o.next&&(e.tail=o),null===o.prev&&(e.head=o),e.length++,o}function n(e,t){e.tail=new r(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new r(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function r(e,t,n,o){if(!(this instanceof r))return new r(e,t,n,o);this.list=o,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}ne=1,te=e,e.Node=r,e.create=e,e.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},e.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},e.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},e.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)n(this,arguments[e]);return this.length},e.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},e.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},e.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},e.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,o=0;null!==n;o++)e.call(t,n.value,o,this),n=n.next},e.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,o=this.length-1;null!==n;o--)e.call(t,n.value,o,this),n=n.prev},e.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},e.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},e.prototype.map=function(t,n){n=n||this;for(var o=new e,r=this.head;null!==r;)o.push(t.call(n,r.value,this)),r=r.next;return o},e.prototype.mapReverse=function(t,n){n=n||this;for(var o=new e,r=this.tail;null!==r;)o.push(t.call(n,r.value,this)),r=r.prev;return o},e.prototype.reduce=function(e,t){var n,o=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");o=this.head.next,n=this.head.value}for(var r=0;null!==o;r++)n=e(n,o.value,r),o=o.next;return n},e.prototype.reduceReverse=function(e,t){var n,o=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");o=this.tail.prev,n=this.tail.value}for(var r=this.length-1;null!==o;r--)n=e(n,o.value,r),o=o.prev;return n},e.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},e.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},e.prototype.slice=function(t,n){(n=n||this.length)<0&&(n+=this.length),(t=t||0)<0&&(t+=this.length);var o=new e;if(n<t||n<0)return o;t<0&&(t=0),n>this.length&&(n=this.length);for(var r=0,a=this.head;null!==a&&r<t;r++)a=a.next;for(;null!==a&&r<n;r++,a=a.next)o.push(a.value);return o},e.prototype.sliceReverse=function(t,n){(n=n||this.length)<0&&(n+=this.length),(t=t||0)<0&&(t+=this.length);var o=new e;if(n<t||n<0)return o;t<0&&(t=0),n>this.length&&(n=this.length);for(var r=this.length,a=this.tail;null!==a&&r>n;r--)a=a.prev;for(;null!==a&&r>t;r--,a=a.prev)o.push(a.value);return o},e.prototype.splice=function(e,n,...o){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,a=this.head;null!==a&&r<e;r++)a=a.next;var i=[];for(r=0;a&&r<n;r++)i.push(a.value),a=this.removeNode(a);null===a&&(a=this.tail),a!==this.head&&a!==this.tail&&(a=a.prev);for(r=0;r<o.length;r++)a=t(this,a,o[r]);return i},e.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var o=n.prev;n.prev=n.next,n.next=o}return this.head=t,this.tail=e,this};try{(ee?Y:(ee=1,Y=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}))(e)}catch(e){}return te}function Ge(){if(re)return oe;re=1;const e=ze(),t=Symbol("max"),n=Symbol("length"),o=Symbol("lengthCalculator"),r=Symbol("allowStale"),a=Symbol("maxAge"),i=Symbol("dispose"),s=Symbol("noDisposeOnSet"),l=Symbol("lruList"),c=Symbol("cache"),d=Symbol("updateAgeOnGet"),u=()=>1;const p=(e,t,n)=>{const o=e[c].get(t);if(o){const t=o.value;if(f(e,t)){if(v(e,o),!e[r])return}else n&&(e[d]&&(o.value.now=Date.now()),e[l].unshiftNode(o));return t.value}},f=(e,t)=>{if(!t||!t.maxAge&&!e[a])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[a]&&n>e[a]},h=e=>{if(e[n]>e[t])for(let o=e[l].tail;e[n]>e[t]&&null!==o;){const t=o.prev;v(e,o),o=t}},v=(e,t)=>{if(t){const o=t.value;e[i]&&e[i](o.key,o.value),e[n]-=o.length,e[c].delete(o.key),e[l].removeNode(t)}};class g{constructor(e,t,n,o,r){this.key=e,this.value=t,this.length=n,this.now=o,this.maxAge=r||0}}const y=(e,t,n,o)=>{let a=n.value;f(e,a)&&(v(e,n),e[r]||(a=void 0)),a&&t.call(o,a.value,a.key,e)};return oe=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[t]=e.max||1/0;const n=e.length||u;if(this[o]="function"!=typeof n?u:n,this[r]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[a]=e.maxAge||0,this[i]=e.dispose,this[s]=e.noDisposeOnSet||!1,this[d]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[t]=e||1/0,h(this)}get max(){return this[t]}set allowStale(e){this[r]=!!e}get allowStale(){return this[r]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[a]=e,h(this)}get maxAge(){return this[a]}set lengthCalculator(e){"function"!=typeof e&&(e=u),e!==this[o]&&(this[o]=e,this[n]=0,this[l].forEach((e=>{e.length=this[o](e.value,e.key),this[n]+=e.length}))),h(this)}get lengthCalculator(){return this[o]}get length(){return this[n]}get itemCount(){return this[l].length}rforEach(e,t){t=t||this;for(let n=this[l].tail;null!==n;){const o=n.prev;y(this,e,n,t),n=o}}forEach(e,t){t=t||this;for(let n=this[l].head;null!==n;){const o=n.next;y(this,e,n,t),n=o}}keys(){return this[l].toArray().map((e=>e.key))}values(){return this[l].toArray().map((e=>e.value))}reset(){this[i]&&this[l]&&this[l].length&&this[l].forEach((e=>this[i](e.key,e.value))),this[c]=new Map,this[l]=new e,this[n]=0}dump(){return this[l].map((e=>!f(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[l]}set(e,r,d){if((d=d||this[a])&&"number"!=typeof d)throw new TypeError("maxAge must be a number");const u=d?Date.now():0,p=this[o](r,e);if(this[c].has(e)){if(p>this[t])return v(this,this[c].get(e)),!1;const o=this[c].get(e).value;return this[i]&&(this[s]||this[i](e,o.value)),o.now=u,o.maxAge=d,o.value=r,this[n]+=p-o.length,o.length=p,this.get(e),h(this),!0}const f=new g(e,r,p,u,d);return f.length>this[t]?(this[i]&&this[i](e,r),!1):(this[n]+=f.length,this[l].unshift(f),this[c].set(e,this[l].head),h(this),!0)}has(e){if(!this[c].has(e))return!1;const t=this[c].get(e).value;return!f(this,t)}get(e){return p(this,e,!0)}peek(e){return p(this,e,!1)}pop(){const e=this[l].tail;return e?(v(this,e),e.value):null}del(e){v(this,this[c].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const o=e[n],r=o.e||0;if(0===r)this.set(o.k,o.v);else{const e=r-t;e>0&&this.set(o.k,o.v,e)}}}prune(){this[c].forEach(((e,t)=>p(this,t,!1)))}}}function $e(){if(le)return se;le=1;const{isArray:e,isObject:t,isString:n}=Je(),{asArray:o}=He(),{prependBase:r}=Ue(),a=Be(),i=function(){if(ie)return ae;ie=1;const e=Ge();return ae=class{constructor({document:t}){this.document=t,this.cache=new e({max:10})}getProcessed(e){return this.cache.get(e)}setProcessed(e,t){this.cache.set(e,t)}}}();function s(e){throw new a("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:e})}function l({context:o,base:a}){if(!o)return;const i=o["@context"];if(n(i))o["@context"]=r(a,i);else if(e(i))for(let e=0;e<i.length;++e){const o=i[e];n(o)?i[e]=r(a,o):t(o)&&l({context:{"@context":o},base:a})}else if(t(i))for(const e in i)l({context:i[e],base:a})}return se=class{constructor({sharedCache:e}){this.perOpCache=new Map,this.sharedCache=e}async resolve({activeCtx:r,context:a,documentLoader:l,base:c,cycles:d=new Set}){a&&t(a)&&a["@context"]&&(a=a["@context"]),a=o(a);const u=[];for(const o of a){if(n(o)){let t=this._get(o);t||(t=await this._resolveRemoteContext({activeCtx:r,url:o,documentLoader:l,base:c,cycles:d})),e(t)?u.push(...t):u.push(t);continue}if(null===o){u.push(new i({document:null}));continue}t(o)||s(a);const p=JSON.stringify(o);let f=this._get(p);f||(f=new i({document:o}),this._cacheResolvedContext({key:p,resolved:f,tag:"static"})),u.push(f)}return u}_get(e){let t=this.perOpCache.get(e);if(!t){const n=this.sharedCache.get(e);n&&(t=n.get("static"),t&&this.perOpCache.set(e,t))}return t}_cacheResolvedContext({key:e,resolved:t,tag:n}){if(this.perOpCache.set(e,t),void 0!==n){let o=this.sharedCache.get(e);o||(o=new Map,this.sharedCache.set(e,o)),o.set(n,t)}return t}async _resolveRemoteContext({activeCtx:e,url:t,documentLoader:n,base:o,cycles:a}){t=r(o,t);const{context:i,remoteDoc:s}=await this._fetchContext({activeCtx:e,url:t,documentLoader:n,cycles:a});l({context:i,base:o=s.documentUrl||t});const c=await this.resolve({activeCtx:e,context:i,documentLoader:n,base:o,cycles:a});return this._cacheResolvedContext({key:t,resolved:c,tag:s.tag}),c}async _fetchContext({activeCtx:o,url:r,documentLoader:i,cycles:s}){if(s.size>10)throw new a("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===o.processingMode?"loading remote context failed":"context overflow",max:10});if(s.has(r))throw new a("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===o.processingMode?"recursive context inclusion":"context overflow",url:r});let l,c;s.add(r);try{c=await i(r),l=c.document||null,n(l)&&(l=JSON.parse(l))}catch(e){throw new a("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:r,cause:e})}if(!t(l))throw new a("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:r});return l="@context"in l?{"@context":l["@context"]}:{"@context":{}},c.contextUrl&&(e(l["@context"])||(l["@context"]=[l["@context"]]),l["@context"].push(c.contextUrl)),{context:l,remoteDoc:c}}},se}function Qe(){return de?ce:(de=1,ce=Me().NQuads)}function Xe(){if(pe)return ue;pe=1;const e=Be(),{isArray:t}=Je(),{asArray:n}=He(),o={};function r({event:n,handlers:o}){let a=!0;for(let i=0;a&&i<o.length;++i){a=!1;const s=o[i];if(t(s))a=r({event:n,handlers:s});else if("function"==typeof s)s({event:n,next:()=>{a=!0}});else{if("object"!=typeof s)throw new e("Invalid event handler.","jsonld.InvalidEventHandler",{event:n});n.code in s?s[n.code]({event:n,next:()=>{a=!0}}):a=!0}}return a}ue=o,o.defaultEventHandler=null,o.setupEventHandler=({options:e={}})=>{const t=[].concat(e.safe?o.safeEventHandler:[],e.eventHandler?n(e.eventHandler):[],o.defaultEventHandler?o.defaultEventHandler:[]);return 0===t.length?null:t},o.handleEvent=({event:e,options:t})=>{r({event:e,handlers:t.eventHandler})};const a=new Set(["empty object","free-floating scalar","invalid @language value","invalid property","null @id value","null @value value","object with only @id","object with only @language","object with only @list","object with only @value","relative @id reference","relative @type reference","relative @vocab reference","reserved @id value","reserved @reverse value","reserved term","blank node predicate","relative graph reference","relative object reference","relative predicate reference","relative subject reference","rdfDirection not set"]);return o.safeEventHandler=function({event:t,next:n}){if("warning"===t.level&&a.has(t.code))throw new e("Safe mode validation error.","jsonld.ValidationError",{event:t});n()},o.logEventHandler=function({event:e,next:t}){console.log(`EVENT: ${e.message}`,{event:e}),t()},o.logWarningEventHandler=function({event:e,next:t}){"warning"===e.level&&console.warn(`WARNING: ${e.message}`,{event:e}),t()},o.unhandledEventHandler=function({event:t}){throw new e("No handler for event.","jsonld.UnhandledEvent",{event:t})},o.setDefaultEventHandler=function({eventHandler:e}={}){o.defaultEventHandler=e?n(e):null},ue}function We(){if(he)return fe;he=1;const e=He(),t=Be(),{isArray:n,isObject:o,isString:r,isUndefined:a}=Je(),{isAbsolute:i,isRelative:s,prependBase:l}=Ue(),{handleEvent:c}=Xe(),{REGEX_BCP47:d,REGEX_KEYWORD:u,asArray:p,compareShortestLeast:f}=He(),h=new Map,v={};function g(e,t,n,a,s,c){if(null===t||!r(t)||v.isKeyword(t))return t;if(t.match(u))return null;if(a&&a.hasOwnProperty(t)&&!0!==s.get(t)&&v.createTermDefinition({activeCtx:e,localCtx:a,term:t,defined:s,options:c}),(n=n||{}).vocab){const n=e.mappings.get(t);if(null===n)return null;if(o(n)&&"@id"in n)return n["@id"]}const d=t.indexOf(":");if(d>0){const n=t.substr(0,d),o=t.substr(d+1);if("_"===n||0===o.indexOf("//"))return t;a&&a.hasOwnProperty(n)&&v.createTermDefinition({activeCtx:e,localCtx:a,term:n,defined:s,options:c});const r=e.mappings.get(n);if(r&&r._prefix)return r["@id"]+o;if(i(t))return t}if(n.vocab&&"@vocab"in e){t=e["@vocab"]+t}else if(n.base){let n,o;"@base"in e?e["@base"]?(o=l(c.base,e["@base"]),n=l(o,t)):(o=e["@base"],n=t):(o=c.base,n=l(c.base,t)),t=n}return t}function y(e,t){if(!e||"object"!=typeof e||!t||"object"!=typeof t)return e===t;const n=Array.isArray(e);if(n!==Array.isArray(t))return!1;if(n){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!y(e[n],t[n]))return!1;return!0}const o=Object.keys(e),r=Object.keys(t);if(o.length!==r.length)return!1;for(const n in e){let o=e[n],r=t[n];if("@container"===n&&Array.isArray(o)&&Array.isArray(r)&&(o=o.slice().sort(),r=r.slice().sort()),!y(o,r))return!1}return!0}return fe=v,v.process=async({activeCtx:e,localCtx:a,options:u,propagate:f=!0,overrideProtected:h=!1,cycles:y=new Set})=>{o(a)&&"@context"in a&&n(a["@context"])&&(a=a["@context"]);if(0===p(a).length)return e;const m=[],x=[({event:e,next:t})=>{m.push(e),t()}];u.eventHandler&&x.push(u.eventHandler);const b=u;u={...u,eventHandler:x};const w=await u.contextResolver.resolve({activeCtx:e,context:a,documentLoader:u.documentLoader,base:u.base});o(w[0].document)&&"boolean"==typeof w[0].document["@propagate"]&&(f=w[0].document["@propagate"]);let j=e;f||j.previousContext||(j=j.clone(),j.previousContext=e);for(const n of w){let{document:p}=n;if(e=j,null===p){if(!h&&0!==Object.keys(e.protected).length)throw new t("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});j=e=v.getInitialContext(u).clone();continue}const f=n.getProcessed(e);if(f){if(b.eventHandler)for(const e of f.events)c({event:e,options:b});j=e=f.context;continue}if(o(p)&&"@context"in p&&(p=p["@context"]),!o(p))throw new t("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:p});j=j.clone();const x=new Map;if("@version"in p){if(1.1!==p["@version"])throw new t("Unsupported JSON-LD version: "+p["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:p});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new t("@version: "+p["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:p});j.processingMode="json-ld-1.1",j["@version"]=p["@version"],x.set("@version",!0)}if(j.processingMode=j.processingMode||e.processingMode,"@base"in p){let e=p["@base"];if(null===e||i(e));else{if(!s(e))throw new t('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:p});e=l(j["@base"],e)}j["@base"]=e,x.set("@base",!0)}if("@vocab"in p){const e=p["@vocab"];if(null===e)delete j["@vocab"];else{if(!r(e))throw new t('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:p});if(!i(e)&&v.processingMode(j,1))throw new t('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:p});{const t=g(j,e,{vocab:!0,base:!0},void 0,void 0,u);i(t)||u.eventHandler&&c({event:{type:["JsonLdEvent"],code:"relative @vocab reference",level:"warning",message:"Relative @vocab reference found.",details:{vocab:t}},options:u}),j["@vocab"]=t}}x.set("@vocab",!0)}if("@language"in p){const e=p["@language"];if(null===e)delete j["@language"];else{if(!r(e))throw new t('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:p});e.match(d)||u.eventHandler&&c({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:u}),j["@language"]=e.toLowerCase()}x.set("@language",!0)}if("@direction"in p){const n=p["@direction"];if("json-ld-1.0"===e.processingMode)throw new t("Invalid JSON-LD syntax; @direction not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:p});if(null===n)delete j["@direction"];else{if("ltr"!==n&&"rtl"!==n)throw new t('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:p});j["@direction"]=n}x.set("@direction",!0)}if("@propagate"in p){const n=p["@propagate"];if("json-ld-1.0"===e.processingMode)throw new t("Invalid JSON-LD syntax; @propagate not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:p});if("boolean"!=typeof n)throw new t("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:a});x.set("@propagate",!0)}if("@import"in p){const n=p["@import"];if("json-ld-1.0"===e.processingMode)throw new t("Invalid JSON-LD syntax; @import not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:p});if(!r(n))throw new t("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:a});const o=await u.contextResolver.resolve({activeCtx:e,context:n,documentLoader:u.documentLoader,base:u.base});if(1!==o.length)throw new t("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:a});const i=o[0].getProcessed(e);if(i)p=i;else{const n=o[0].document;if("@import"in n)throw new t("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:a});for(const e in n)p.hasOwnProperty(e)||(p[e]=n[e]);o[0].setProcessed(e,p)}x.set("@import",!0)}x.set("@protected",p["@protected"]||!1);for(const e in p)if(v.createTermDefinition({activeCtx:j,localCtx:p,term:e,defined:x,options:u,overrideProtected:h}),o(p[e])&&"@context"in p[e]){const n=p[e]["@context"];let o=!0;if(r(n)){const e=l(u.base,n);y.has(e)?o=!1:y.add(e)}if(o)try{await v.process({activeCtx:j.clone(),localCtx:p[e]["@context"],overrideProtected:!0,options:u,cycles:y})}catch(n){throw new t("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:p[e]["@context"],term:e})}}n.setProcessed(e,{context:j,events:m})}return j},v.createTermDefinition=({activeCtx:e,localCtx:a,term:s,defined:l,options:d,overrideProtected:p=!1})=>{if(l.has(s)){if(l.get(s))return;throw new t("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:a,term:s})}let f;if(l.set(s,!1),a.hasOwnProperty(s)&&(f=a[s]),"@type"===s&&o(f)&&"@set"===(f["@container"]||"@set")&&v.processingMode(e,1.1)){const e=["@container","@id","@protected"],n=Object.keys(f);if(0===n.length||n.some((t=>!e.includes(t))))throw new t("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:a,term:s})}else{if(v.isKeyword(s))throw new t("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:a,term:s});if(s.match(u))return void(d.eventHandler&&c({event:{type:["JsonLdEvent"],code:"reserved term",level:"warning",message:'Terms beginning with "@" are reserved for future use and dropped.',details:{term:s}},options:d}));if(""===s)throw new t("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:a})}const h=e.mappings.get(s);e.mappings.has(s)&&e.mappings.delete(s);let m=!1;if((r(f)||null===f)&&(m=!0,f={"@id":f}),!o(f))throw new t("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:a});const x={};e.mappings.set(s,x),x.reverse=!1;const b=["@container","@id","@language","@reverse","@type"];v.processingMode(e,1.1)&&b.push("@context","@direction","@index","@nest","@prefix","@protected");for(const e in f)if(!b.includes(e))throw new t("Invalid JSON-LD syntax; a term definition must not contain "+e,"jsonld.SyntaxError",{code:"invalid term definition",context:a});const w=s.indexOf(":");if(x._termHasColon=w>0,"@reverse"in f){if("@id"in f)throw new t("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:a});if("@nest"in f)throw new t("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:a});const n=f["@reverse"];if(!r(n))throw new t("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:a});if(n.match(u))return d.eventHandler&&c({event:{type:["JsonLdEvent"],code:"reserved @reverse value",level:"warning",message:'@reverse values beginning with "@" are reserved for future use and dropped.',details:{reverse:n}},options:d}),void(h?e.mappings.set(s,h):e.mappings.delete(s));const o=g(e,n,{vocab:!0,base:!1},a,l,d);if(!i(o))throw new t("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:a});x["@id"]=o,x.reverse=!0}else if("@id"in f){let n=f["@id"];if(n&&!r(n))throw new t("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:a});if(null===n)x["@id"]=null;else{if(!v.isKeyword(n)&&n.match(u))return d.eventHandler&&c({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:'@id values beginning with "@" are reserved for future use and dropped.',details:{id:n}},options:d}),void(h?e.mappings.set(s,h):e.mappings.delete(s));if(n!==s){if(n=g(e,n,{vocab:!0,base:!1},a,l,d),!i(n)&&!v.isKeyword(n))throw new t("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:a});if(s.match(/(?::[^:])|\//)){if(g(e,s,{vocab:!0,base:!1},a,new Map(l).set(s,!0),d)!==n)throw new t("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:a})}x["@id"]=n,x._prefix=m&&!x._termHasColon&&null!==n.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in x))if(x._termHasColon){const t=s.substr(0,w);if(a.hasOwnProperty(t)&&v.createTermDefinition({activeCtx:e,localCtx:a,term:t,defined:l,options:d}),e.mappings.has(t)){const n=s.substr(w+1);x["@id"]=e.mappings.get(t)["@id"]+n}else x["@id"]=s}else if("@type"===s)x["@id"]=s;else{if(!("@vocab"in e))throw new t("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:a,term:s});x["@id"]=e["@vocab"]+s}if((!0===f["@protected"]||!0===l.get("@protected")&&!1!==f["@protected"])&&(e.protected[s]=!0,x.protected=!0),l.set(s,!0),"@type"in f){let n=f["@type"];if(!r(n))throw new t("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:a});if("@json"===n||"@none"===n){if(v.processingMode(e,1))throw new t(`Invalid JSON-LD syntax; an @context @type value must not be "${n}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:a})}else if("@id"!==n&&"@vocab"!==n){if(n=g(e,n,{vocab:!0,base:!1},a,l,d),!i(n))throw new t("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:a});if(0===n.indexOf("_:"))throw new t("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:a})}x["@type"]=n}if("@container"in f){const o=r(f["@container"])?[f["@container"]]:f["@container"]||[],i=["@list","@set","@index","@language"];let s=!0;const l=o.includes("@set");if(v.processingMode(e,1.1)){if(i.push("@graph","@id","@type"),o.includes("@list")){if(1!==o.length)throw new t("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:a})}else if(o.includes("@graph")){if(o.some((e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e)))throw new t("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:a})}else s&=o.length<=(l?2:1);if(o.includes("@type")&&(x["@type"]=x["@type"]||"@id",!["@id","@vocab"].includes(x["@type"])))throw new t("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:a})}else s&=!n(f["@container"]),s&=o.length<=1;if(s&=o.every((e=>i.includes(e))),s&=!(l&&o.includes("@list")),!s)throw new t("Invalid JSON-LD syntax; @context @container value must be one of the following: "+i.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:a});if(x.reverse&&!o.every((e=>["@index","@set"].includes(e))))throw new t("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:a});x["@container"]=o}if("@index"in f){if(!("@container"in f)||!x["@container"].includes("@index"))throw new t(`Invalid JSON-LD syntax; @index without @index in @container: "${f["@index"]}" on term "${s}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:a});if(!r(f["@index"])||0===f["@index"].indexOf("@"))throw new t(`Invalid JSON-LD syntax; @index must expand to an IRI: "${f["@index"]}" on term "${s}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:a});x["@index"]=f["@index"]}if("@context"in f&&(x["@context"]=f["@context"]),"@language"in f&&!("@type"in f)){let e=f["@language"];if(null!==e&&!r(e))throw new t("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:a});null!==e&&(e=e.toLowerCase()),x["@language"]=e}if("@prefix"in f){if(s.match(/:|\//))throw new t("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:a});if(v.isKeyword(x["@id"]))throw new t("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:a});if("boolean"!=typeof f["@prefix"])throw new t("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:a});x._prefix=!0===f["@prefix"]}if("@direction"in f){const e=f["@direction"];if(null!==e&&"ltr"!==e&&"rtl"!==e)throw new t('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:a});x["@direction"]=e}if("@nest"in f){const e=f["@nest"];if(!r(e)||"@nest"!==e&&0===e.indexOf("@"))throw new t("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:a});x["@nest"]=e}
// disallow aliasing @context and @preserve
const j=x["@id"];if("@context"===j||"@preserve"===j)throw new t("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:a});if(h&&h.protected&&!p&&(e.protected[s]=!0,x.protected=!0,!y(h,x)))throw new t("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:a,term:s})},v.expandIri=(e,t,n,o)=>g(e,t,n,void 0,void 0,o),v.getInitialContext=t=>{const n=JSON.stringify({processingMode:t.processingMode}),o=h.get(n);if(o)return o;const r={processingMode:t.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const t=e.inverse={},n=e.fastCurieMap={},o={},r=(e["@language"]||"@none").toLowerCase(),s=e["@direction"],l=e.mappings,c=[...l.keys()].sort(f);for(const e of c){const a=l.get(e);if(null===a)continue;let c=a["@container"]||"@none";if(c=[].concat(c).sort().join(""),null===a["@id"])continue;const d=p(a["@id"]);for(const l of d){let d=t[l];const u=v.isKeyword(l);if(d)u||a._termHasColon||o[l].push(e);else if(t[l]=d={},!u&&!a._termHasColon){o[l]=[e];const t={iri:l,terms:o[l]};l[0]in n?n[l[0]].push(t):n[l[0]]=[t]}if(d[c]||(d[c]={"@language":{},"@type":{},"@any":{}}),d=d[c],i(e,d["@any"],"@none"),a.reverse)i(e,d["@type"],"@reverse");else if("@none"===a["@type"])i(e,d["@any"],"@none"),i(e,d["@language"],"@none"),i(e,d["@type"],"@none");else if("@type"in a)i(e,d["@type"],a["@type"]);else if("@language"in a&&"@direction"in a){const t=a["@language"],n=a["@direction"];i(e,d["@language"],t&&n?`${t}_${n}`.toLowerCase():t?t.toLowerCase():n?`_${n}`:"@null")}else"@language"in a?i(e,d["@language"],(a["@language"]||"@null").toLowerCase()):"@direction"in a?a["@direction"]?i(e,d["@language"],`_${a["@direction"]}`):i(e,d["@language"],"@none"):s?(i(e,d["@language"],`_${s}`),i(e,d["@language"],"@none"),i(e,d["@type"],"@none")):(i(e,d["@language"],r),i(e,d["@language"],"@none"),i(e,d["@type"],"@none"))}}for(const e in n)a(n,e,1);return t},clone:function(){const t={};t.mappings=e.clone(this.mappings),t.clone=this.clone,t.inverse=null,t.getInverse=this.getInverse,t.protected=e.clone(this.protected),this.previousContext&&(t.previousContext=this.previousContext.clone());t.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(t["@base"]=this["@base"]);"@language"in this&&(t["@language"]=this["@language"]);"@vocab"in this&&(t["@vocab"]=this["@vocab"]);return t},revertToPreviousContext:function(){if(!this.previousContext)return this;return this.previousContext.clone()},protected:{}};return 1e4===h.size&&h.clear(),h.set(n,r),r;function a(e,t,n){const o=e[t],r=e[t]={};let i,s;for(const e of o)i=e.iri,s=n>=i.length?"":i[n],s in r?r[s].push(e):r[s]=[e];for(const e in r)""!==e&&a(r,e,n+1)}function i(e,t,n){t.hasOwnProperty(n)||(t[n]=e)}},v.getContextValue=(e,t,n)=>{if(null===t){if("@context"===n)return;return null}if(e.mappings.has(t)){const o=e.mappings.get(t);if(a(n))return o;if(o.hasOwnProperty(n))return o[n]}return"@language"===n&&n in e||"@direction"===n&&n in e?e[n]:"@context"!==n?null:void 0},v.processingMode=(e,t)=>t.toString()>="1.1"?!e.processingMode||e.processingMode>="json-ld-"+t.toString():"json-ld-1.0"===e.processingMode,v.isKeyword=e=>{if(!r(e)||"@"!==e[0])return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1},fe}function Ke(){if(ge)return ve;ge=1;const e=Be(),{isArray:t,isObject:n,isEmptyObject:o,isString:r,isUndefined:a}=Je(),{isList:i,isValue:s,isGraph:l,isSubject:c}=Pe(),{expandIri:d,getContextValue:u,isKeyword:p,process:f,processingMode:h}=We(),{isAbsolute:v}=Ue(),{REGEX_BCP47:g,REGEX_KEYWORD:y,addValue:m,asArray:x,getValues:b,validateTypeValue:w}=He(),{handleEvent:j}=Xe(),I={};function N({value:e,count:t,options:n}){if(0===t||"@value"in e||"@list"in e||1===t&&"@id"in e){if(n.eventHandler){let o,r;0===t?(o="empty object",r="Dropping empty object."):"@value"in e?(o="object with only @value",r="Dropping object with only @value."):"@list"in e?(o="object with only @list",r="Dropping object with only @list."):1===t&&"@id"in e&&(o="object with only @id",r="Dropping object with only @id."),j({event:{type:["JsonLdEvent"],code:o,level:"warning",message:r,details:{value:e}},options:n})}return null}return e}async function S({activeCtx:l,activeProperty:y,expandedActiveProperty:b,element:O,expandedParent:k,options:C={},insideList:L,typeKey:R,typeScopedContext:T}){const A=Object.keys(O).sort(),_=[];let M;const J=O[R]&&"@json"===d(l,t(O[R])?O[R][0]:O[R],{vocab:!0},{...C,typeExpansion:!0});for(const S of A){let L,R=O[S];if("@context"===S)continue;const A=d(l,S,{vocab:!0},C);if(null===A||!v(A)&&!p(A)){C.eventHandler&&j({event:{type:["JsonLdEvent"],code:"invalid property",level:"warning",message:"Dropping property that did not expand into an absolute IRI or keyword.",details:{property:S,expandedProperty:A}},options:C});continue}if(p(A)){if("@reverse"===b)throw new e("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:R});if(A in k&&"@included"!==A&&"@type"!==A)throw new e("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:A})}if("@id"===A){if(!r(R)){if(!C.isFrame)throw new e('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:R});if(n(R)){if(!o(R))throw new e('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:R})}else{if(!t(R))throw new e('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:R});if(!R.every((e=>r(e))))throw new e('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:R})}}m(k,"@id",x(R).map((e=>{if(r(e)){const t=d(l,e,{base:!0},C);return C.eventHandler&&(null===t?j(null===e?{event:{type:["JsonLdEvent"],code:"null @id value",level:"warning",message:"Null @id found.",details:{id:e}},options:C}:{event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:e}},options:C}):v(t)||j({event:{type:["JsonLdEvent"],code:"relative @id reference",level:"warning",message:"Relative @id reference found.",details:{id:e,expandedId:t}},options:C})),t}return e})),{propertyIsArray:C.isFrame});continue}if("@type"===A){n(R)&&(R=Object.fromEntries(Object.entries(R).map((([e,t])=>[d(T,e,{vocab:!0}),x(t).map((e=>d(T,e,{base:!0,vocab:!0},{...C,typeExpansion:!0})))])))),w(R,C.isFrame),m(k,"@type",x(R).map((e=>{if(r(e)){const t=d(T,e,{base:!0,vocab:!0},{...C,typeExpansion:!0});return"@json"===t||v(t)||C.eventHandler&&j({event:{type:["JsonLdEvent"],code:"relative @type reference",level:"warning",message:"Relative @type reference found.",details:{type:e}},options:C}),t}return e})),{propertyIsArray:!!C.isFrame});continue}if("@included"===A&&h(l,1.1)){const t=x(await I.expand({activeCtx:l,activeProperty:y,element:R,options:C}));if(!t.every((e=>c(e))))throw new e("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:R});m(k,"@included",t,{propertyIsArray:!0});continue}if("@graph"===A&&!n(R)&&!t(R))throw new e('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:R});if("@value"===A){M=R,J&&h(l,1.1)?k["@value"]=R:m(k,"@value",R,{propertyIsArray:C.isFrame});continue}if("@language"===A){if(null===R)continue;if(!r(R)&&!C.isFrame)throw new e('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:R});R=x(R).map((e=>r(e)?e.toLowerCase():e));for(const e of R)r(e)&&!e.match(g)&&C.eventHandler&&j({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:C});m(k,"@language",R,{propertyIsArray:C.isFrame});continue}if("@direction"===A){if(!r(R)&&!C.isFrame)throw new e('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:R});R=x(R);for(const t of R)if(r(t)&&"ltr"!==t&&"rtl"!==t)throw new e('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:R});m(k,"@direction",R,{propertyIsArray:C.isFrame});continue}if("@index"===A){if(!r(R))throw new e('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:R});m(k,"@index",R);continue}if("@reverse"===A){if(!n(R))throw new e('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:R});if(L=await I.expand({activeCtx:l,activeProperty:"@reverse",element:R,options:C}),"@reverse"in L)for(const e in L["@reverse"])m(k,e,L["@reverse"][e],{propertyIsArray:!0});let t=k["@reverse"]||null;for(const n in L){if("@reverse"===n)continue;null===t&&(t=k["@reverse"]={}),m(t,n,[],{propertyIsArray:!0});const o=L[n];for(let r=0;r<o.length;++r){const a=o[r];if(s(a)||i(a))throw new e('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:L});m(t,n,a,{propertyIsArray:!0})}}continue}if("@nest"===A){_.push(S);continue}let P=l;const B=u(l,S,"@context");a(B)||(P=await f({activeCtx:l,localCtx:B,propagate:!0,overrideProtected:!0,options:C}));const H=u(l,S,"@container")||[];if(H.includes("@language")&&n(R)){L=E(P,R,u(P,S,"@direction"),C)}else if(H.includes("@index")&&n(R)){const e=H.includes("@graph"),t=u(P,S,"@index")||"@index",n="@index"!==t&&d(l,t,{vocab:!0},C);L=await D({activeCtx:P,options:C,activeProperty:S,value:R,asGraph:e,indexKey:t,propertyIndex:n})}else if(H.includes("@id")&&n(R)){const e=H.includes("@graph");L=await D({activeCtx:P,options:C,activeProperty:S,value:R,asGraph:e,indexKey:"@id"})}else if(H.includes("@type")&&n(R))L=await D({activeCtx:P.revertToPreviousContext(),options:C,activeProperty:S,value:R,asGraph:!1,indexKey:"@type"});else{const e="@list"===A;if(e||"@set"===A){let t=y;e&&"@graph"===b&&(t=null),L=await I.expand({activeCtx:P,activeProperty:t,element:R,options:C,insideList:e})}else L="@json"===u(l,S,"@type")?{"@type":"@json","@value":R}:await I.expand({activeCtx:P,activeProperty:S,element:R,options:C,insideList:!1})}if(null!==L||"@value"===A){if("@list"!==A&&!i(L)&&H.includes("@list")&&(L={"@list":x(L)}),H.includes("@graph")&&!H.some((e=>"@id"===e||"@index"===e))){if(L=x(L),C.isFrame||(L=L.filter((e=>null!==N({value:e,count:Object.keys(e).length,options:C})))),0===L.length)continue;L=L.map((e=>({"@graph":x(e)})))}if(P.mappings.has(S)&&P.mappings.get(S).reverse){const t=k["@reverse"]=k["@reverse"]||{};L=x(L);for(let n=0;n<L.length;++n){const o=L[n];if(s(o)||i(o))throw new e('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:L});m(t,A,o,{propertyIsArray:!0})}}else m(k,A,L,{propertyIsArray:!0})}}if("@value"in k)if("@json"===k["@type"]&&h(l,1.1));else if((n(M)||t(M))&&!C.isFrame)throw new e('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:M});for(const o of _){const r=t(O[o])?O[o]:[O[o]];for(const t of r){if(!n(t)||Object.keys(t).some((e=>"@value"===d(l,e,{vocab:!0},C))))throw new e("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:t});await S({activeCtx:l,activeProperty:y,expandedActiveProperty:b,element:t,expandedParent:k,options:C,insideList:L,typeScopedContext:T,typeKey:R})}}}function O({activeCtx:e,activeProperty:t,value:n,options:o}){if(null==n)return null;const a=d(e,t,{vocab:!0},o);if("@id"===a)return d(e,n,{base:!0},o);if("@type"===a)return d(e,n,{vocab:!0,base:!0},{...o,typeExpansion:!0});const i=u(e,t,"@type");if(("@id"===i||"@graph"===a)&&r(n)){const r=d(e,n,{base:!0},o);return null===r&&n.match(y)&&o.eventHandler&&j({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:t}},options:o}),{"@id":r}}if("@vocab"===i&&r(n))return{"@id":d(e,n,{vocab:!0,base:!0},o)};if(p(a))return n;const s={};if(i&&!["@id","@vocab","@none"].includes(i))s["@type"]=i;else if(r(n)){const n=u(e,t,"@language");null!==n&&(s["@language"]=n);const o=u(e,t,"@direction");null!==o&&(s["@direction"]=o)}return["boolean","number","string"].includes(typeof n)||(n=n.toString()),s["@value"]=n,s}function E(n,o,a,i){const s=[],l=Object.keys(o).sort();for(const c of l){const l=d(n,c,{vocab:!0},i);let u=o[c];t(u)||(u=[u]);for(const t of u){if(null===t)continue;if(!r(t))throw new e("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:o});const n={"@value":t};"@none"!==l&&(c.match(g)||i.eventHandler&&j({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:c}},options:i}),n["@language"]=c.toLowerCase()),a&&(n["@direction"]=a),s.push(n)}}return s}async function D({activeCtx:n,options:o,activeProperty:r,value:i,asGraph:c,indexKey:p,propertyIndex:h}){const v=[],g=Object.keys(i).sort(),y="@type"===p;for(let x of g){if(y){const e=u(n,x,"@context");a(e)||(n=await f({activeCtx:n,localCtx:e,propagate:!1,options:o}))}let g,b=i[x];t(b)||(b=[b]),b=await I.expand({activeCtx:n,activeProperty:r,element:b,options:o,insideList:!1,insideIndex:!0}),g=h?"@none"===x?"@none":O({activeCtx:n,activeProperty:p,value:x,options:o}):d(n,x,{vocab:!0},o),"@id"===p?x=d(n,x,{base:!0},o):y&&(x=g);for(let t of b){if(c&&!l(t)&&(t={"@graph":[t]}),"@type"===p)"@none"===g||(t["@type"]?t["@type"]=[x].concat(t["@type"]):t["@type"]=[x]);else{if(s(t)&&!["@language","@type","@index"].includes(p))throw new e(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${p}".`,"jsonld.SyntaxError",{code:"invalid value object",value:t});h?"@none"!==g&&m(t,h,g,{propertyIsArray:!0,prependValue:!0}):"@none"===g||p in t||(t[p]=x)}v.push(t)}}return v}return ve=I,I.expand=async({activeCtx:i,activeProperty:s=null,element:l,options:c={},insideList:p=!1,insideIndex:g=!1,typeScopedContext:y=null})=>{if(null==l)return null;if("@default"===s&&(c=Object.assign({},c,{isFrame:!1})),!t(l)&&!n(l))return p||null!==s&&"@graph"!==d(i,s,{vocab:!0},c)?O({activeCtx:i,activeProperty:s,value:l,options:c}):(c.eventHandler&&j({event:{type:["JsonLdEvent"],code:"free-floating scalar",level:"warning",message:"Dropping free-floating scalar not in a list.",details:{value:l}},options:c}),null);if(t(l)){let e=[];const n=u(i,s,"@container")||[];p=p||n.includes("@list");for(let n=0;n<l.length;++n){let o=await I.expand({activeCtx:i,activeProperty:s,element:l[n],options:c,insideIndex:g,typeScopedContext:y});p&&t(o)&&(o={"@list":o}),null!==o&&(t(o)?e=e.concat(o):e.push(o))}return e}const m=d(i,s,{vocab:!0},c),w=u(i,s,"@context");y=y||(i.previousContext?i:null);let E=Object.keys(l).sort(),D=!g;if(D&&y&&E.length<=2&&!E.includes("@context"))for(const e of E){const t=d(y,e,{vocab:!0},c);if("@value"===t){D=!1,i=y;break}if("@id"===t&&1===E.length){D=!1;break}}D&&(i=i.revertToPreviousContext()),a(w)||(i=await f({activeCtx:i,localCtx:w,propagate:!0,overrideProtected:!0,options:c})),"@context"in l&&(i=await f({activeCtx:i,localCtx:l["@context"],options:c})),y=i;let k=null;for(const e of E){if("@type"===d(i,e,{vocab:!0},c)){k=k||e;const t=l[e],n=Array.isArray(t)?t.length>1?t.slice().sort():t:[t];for(const e of n){const t=u(y,e,"@context");a(t)||(i=await f({activeCtx:i,localCtx:t,options:c,propagate:!1}))}}}let C={};await S({activeCtx:i,activeProperty:s,expandedActiveProperty:m,element:l,expandedParent:C,options:c,insideList:p,typeKey:k,typeScopedContext:y}),E=Object.keys(C);let L=E.length;if("@value"in C){if("@type"in C&&("@language"in C||"@direction"in C))throw new e('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:C});let t=L-1;if("@type"in C&&(t-=1),"@index"in C&&(t-=1),"@language"in C&&(t-=1),"@direction"in C&&(t-=1),0!==t)throw new e('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:C});const n=null===C["@value"]?[]:x(C["@value"]),a=b(C,"@type");if(h(i,1.1)&&a.includes("@json")&&1===a.length);else if(0===n.length)c.eventHandler&&j({event:{type:["JsonLdEvent"],code:"null @value value",level:"warning",message:"Dropping null @value value.",details:{value:C}},options:c}),C=null;else{if(!n.every((e=>r(e)||o(e)))&&"@language"in C)throw new e("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:C});if(!a.every((e=>v(e)&&!(r(e)&&0===e.indexOf("_:"))||o(e))))throw new e('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:C})}}else if("@type"in C&&!t(C["@type"]))C["@type"]=[C["@type"]];else if("@set"in C||"@list"in C){if(L>1&&(2!==L||!("@index"in C)))throw new e('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:C});"@set"in C&&(C=C["@set"],E=Object.keys(C),L=E.length)}else 1===L&&"@language"in C&&(c.eventHandler&&j({event:{type:["JsonLdEvent"],code:"object with only @language",level:"warning",message:"Dropping object with only @language.",details:{value:C}},options:c}),C=null);return!n(C)||c.keepFreeFloatingNodes||p||null!==s&&"@graph"!==m&&!(u(i,s,"@container")||[]).includes("@graph")||(C=N({value:C,count:L,options:c})),C},ve}function Ze(){if(me)return ye;me=1;const{isKeyword:e}=We(),t=Pe(),n=Je(),o=He(),r=Be(),a={};return ye=a,a.createMergedNodeMap=(e,t)=>{const n=(t=t||{}).issuer||new o.IdentifierIssuer("_:b"),r={"@default":{}};return a.createNodeMap(e,r,"@default",n),a.mergeNodeMaps(r)},a.createNodeMap=(i,s,l,c,d,u)=>{if(n.isArray(i)){for(const e of i)a.createNodeMap(e,s,l,c,void 0,u);return}if(!n.isObject(i))return void(u&&u.push(i));if(t.isValue(i)){if("@type"in i){let e=i["@type"];0===e.indexOf("_:")&&(i["@type"]=e=c.getId(e))}return void(u&&u.push(i))}if(u&&t.isList(i)){const e=[];return a.createNodeMap(i["@list"],s,l,c,d,e),void u.push({"@list":e})}if("@type"in i){const e=i["@type"];for(const t of e)0===t.indexOf("_:")&&c.getId(t)}n.isUndefined(d)&&(d=t.isBlankNode(i)?c.getId(i["@id"]):i["@id"]),u&&u.push({"@id":d});const p=s[l],f=p[d]=p[d]||{};f["@id"]=d;const h=Object.keys(i).sort();for(let n of h){if("@id"===n)continue;if("@reverse"===n){const e={"@id":d},n=i["@reverse"];for(const r in n){const i=n[r];for(const n of i){let i=n["@id"];t.isBlankNode(n)&&(i=c.getId(i)),a.createNodeMap(n,s,l,c,i),o.addValue(p[i],r,e,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===n){d in s||(s[d]={}),a.createNodeMap(i[n],s,d,c);continue}if("@included"===n){a.createNodeMap(i[n],s,l,c);continue}if("@type"!==n&&e(n)){if("@index"===n&&n in f&&(i[n]!==f[n]||i[n]["@id"]!==f[n]["@id"]))throw new r("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:f});f[n]=i[n];continue}const u=i[n];if(0===n.indexOf("_:")&&(n=c.getId(n)),0!==u.length)for(let e of u)if("@type"===n&&(e=0===e.indexOf("_:")?c.getId(e):e),t.isSubject(e)||t.isSubjectReference(e)){if("@id"in e&&!e["@id"])continue;const r=t.isBlankNode(e)?c.getId(e["@id"]):e["@id"];o.addValue(f,n,{"@id":r},{propertyIsArray:!0,allowDuplicate:!1}),a.createNodeMap(e,s,l,c,r)}else if(t.isValue(e))o.addValue(f,n,e,{propertyIsArray:!0,allowDuplicate:!1});else if(t.isList(e)){const t=[];a.createNodeMap(e["@list"],s,l,c,d,t),e={"@list":t},o.addValue(f,n,e,{propertyIsArray:!0,allowDuplicate:!1})}else a.createNodeMap(e,s,l,c,d),o.addValue(f,n,e,{propertyIsArray:!0,allowDuplicate:!1});else o.addValue(f,n,[],{propertyIsArray:!0})}},a.mergeNodeMapGraphs=t=>{const n={};for(const r of Object.keys(t).sort())for(const a of Object.keys(t[r]).sort()){const i=t[r][a];a in n||(n[a]={"@id":a});const s=n[a];for(const t of Object.keys(i).sort())if(e(t)&&"@type"!==t)s[t]=o.clone(i[t]);else for(const e of i[t])o.addValue(s,t,o.clone(e),{propertyIsArray:!0,allowDuplicate:!1})}return n},a.mergeNodeMaps=e=>{const n=e["@default"],o=Object.keys(e).sort();for(const r of o){if("@default"===r)continue;const o=e[r];let a=n[r];a?"@graph"in a||(a["@graph"]=[]):n[r]=a={"@id":r,"@graph":[]};const i=a["@graph"];for(const e of Object.keys(o).sort()){const n=o[e];t.isSubjectReference(n)||i.push(n)}}return n},ye}function Ye(){return Ne?Ie:(Ne=1,Ie=function e(t){return null===t||"object"!=typeof t||null!=t.toJSON?JSON.stringify(t):Array.isArray(t)?"["+t.reduce(((t,n,o)=>t+(0===o?"":",")+e(void 0===n||"symbol"==typeof n?null:n)),"")+"]":"{"+Object.keys(t).sort().reduce(((n,o,r)=>{if(void 0===t[o]||"symbol"==typeof t[o])return n;return n+(0===n.length?"":",")+e(o)+":"+e(t[o])}),"")+"}"})}function et(){if(Oe)return Se;Oe=1;const{createNodeMap:e}=Ze(),{isKeyword:t}=We(),n=Pe(),o=Ye(),r=Be(),a=Je(),i=He(),{handleEvent:s}=Xe(),{RDF_FIRST:l,RDF_REST:c,RDF_NIL:d,RDF_TYPE:u,RDF_JSON_LITERAL:p,RDF_LANGSTRING:f,XSD_BOOLEAN:h,XSD_DOUBLE:v,XSD_INTEGER:g,XSD_STRING:y}=Fe(),{isAbsolute:m}=Ue(),x={};function b(e,n,o,r,a){const i=Object.keys(n).sort();for(const l of i){const i=n[l],c=Object.keys(i).sort();for(let n of c){const c=i[n];if("@type"===n)n=u;else if(t(n))continue;for(const t of c){const i={termType:l.startsWith("_:")?"BlankNode":"NamedNode",value:l};if(!m(l)){a.eventHandler&&s({event:{type:["JsonLdEvent"],code:"relative subject reference",level:"warning",message:"Relative subject reference found.",details:{subject:l}},options:a});continue}const c={termType:n.startsWith("_:")?"BlankNode":"NamedNode",value:n};if(!m(n)){a.eventHandler&&s({event:{type:["JsonLdEvent"],code:"relative predicate reference",level:"warning",message:"Relative predicate reference found.",details:{predicate:n}},options:a});continue}if("BlankNode"===c.termType&&!a.produceGeneralizedRdf){a.eventHandler&&s({event:{type:["JsonLdEvent"],code:"blank node predicate",level:"warning",message:"Dropping blank node predicate.",details:{property:r.getOldIds().find((e=>r.getId(e)===n))}},options:a});continue}const d=w(t,r,e,o,a.rdfDirection,a);d&&e.push({subject:i,predicate:c,object:d,graph:o})}}}}function w(e,t,i,u,x,b){const j={};if(n.isValue(e)){j.termType="Literal",j.value=void 0,j.datatype={termType:"NamedNode"};let t=e["@value"];const n=e["@type"]||null;if("@json"===n)j.value=o(t),j.datatype.value=p;else if(a.isBoolean(t))j.value=t.toString(),j.datatype.value=n||h;else if(a.isDouble(t)||n===v)a.isDouble(t)||(t=parseFloat(t)),j.value=t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),j.datatype.value=n||v;else if(a.isNumber(t))j.value=t.toFixed(0),j.datatype.value=n||g;else if("@direction"in e&&"i18n-datatype"===x){const n=`https://www.w3.org/ns/i18n#${(e["@language"]||"").toLowerCase()}_${e["@direction"]}`;j.datatype.value=n,j.value=t}else{if("@direction"in e&&"compound-literal"===x)throw new r("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:x});if("@direction"in e&&x)throw new r("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:x});"@language"in e?("@direction"in e&&!x&&b.eventHandler&&s({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:j.value}},options:b}),j.value=t,j.datatype.value=n||f,j.language=e["@language"]):("@direction"in e&&!x&&b.eventHandler&&s({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:j.value}},options:b}),j.value=t,j.datatype.value=n||y)}}else if(n.isList(e)){const n=function(e,t,n,o,r,a){const i={termType:"NamedNode",value:l},s={termType:"NamedNode",value:c},u={termType:"NamedNode",value:d},p=e.pop(),f=p?{termType:"BlankNode",value:t.getId()}:u;let h=f;for(const l of e){const e=w(l,t,n,o,r,a),c={termType:"BlankNode",value:t.getId()};n.push({subject:h,predicate:i,object:e,graph:o}),n.push({subject:h,predicate:s,object:c,graph:o}),h=c}if(p){const e=w(p,t,n,o,r,a);n.push({subject:h,predicate:i,object:e,graph:o}),n.push({subject:h,predicate:s,object:u,graph:o})}return f}(e["@list"],t,i,u,x,b);j.termType=n.termType,j.value=n.value}else{const t=a.isObject(e)?e["@id"]:e;j.termType=t.startsWith("_:")?"BlankNode":"NamedNode",j.value=t}return"NamedNode"!==j.termType||m(j.value)?j:(b.eventHandler&&s({event:{type:["JsonLdEvent"],code:"relative object reference",level:"warning",message:"Relative object reference found.",details:{object:j.value}},options:b}),null)}return Se=x,x.toRDF=(t,n)=>{const o=new i.IdentifierIssuer("_:b"),r={"@default":{}};e(t,r,"@default",o);const a=[],l=Object.keys(r).sort();for(const e of l){let t;if("@default"===e)t={termType:"DefaultGraph",value:""};else{if(!m(e)){n.eventHandler&&s({event:{type:["JsonLdEvent"],code:"relative graph reference",level:"warning",message:"Relative graph reference found.",details:{graph:e}},options:n});continue}t=e.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},t.value=e}b(a,r[e],t,o,n)}return a},Se}function tt(){if(De)return Ee;De=1;const{isKeyword:e}=We(),t=Pe(),n=Je(),o=He(),r=Ue(),a=Be(),{createNodeMap:i,mergeNodeMapGraphs:s}=Ze(),l={};function c(e){const t={};for(const n in e)void 0!==e[n]&&(t["@"+n]=[e[n]]);return[t]}function d(e,t,n){for(let o=n.length-1;o>=0;--o){const r=n[o];if(r.graph===t&&r.subject["@id"]===e["@id"])return!0}return!1}function u(e,t,n){const o="@"+n;let r=o in e?e[o][0]:t[n];if("embed"===n)if(!0===r)r="@once";else if(!1===r)r="@never";else if("@always"!==r&&"@never"!==r&&"@link"!==r&&"@first"!==r&&"@last"!==r&&"@once"!==r)throw new a("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:e});return r}function p(e){if(!n.isArray(e)||1!==e.length||!n.isObject(e[0]))throw new a("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e});if("@id"in e[0])for(const t of o.asArray(e[0]["@id"]))if(!n.isObject(t)&&!r.isAbsolute(t)||n.isString(t)&&0===t.indexOf("_:"))throw new a("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e});if("@type"in e[0])for(const t of o.asArray(e[0]["@type"]))if(!n.isObject(t)&&!r.isAbsolute(t)&&"@json"!==t||n.isString(t)&&0===t.indexOf("_:"))throw new a("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e})}function f(r,a,i,s){let l=!0,c=!1;for(const d in i){let u=!1;const f=o.getValues(a,d),h=0===o.getValues(i,d).length;if("@id"===d){if(n.isEmptyObject(i["@id"][0]||{})?u=!0:i["@id"].length>=0&&(u=i["@id"].includes(f[0])),!s.requireAll)return u}else if("@type"===d){if(l=!1,h){if(f.length>0)return!1;u=!0}else if(1===i["@type"].length&&n.isEmptyObject(i["@type"][0]))u=f.length>0;else for(const e of i["@type"])u=!(!n.isObject(e)||!("@default"in e))||(u||f.some((t=>t===e)));if(!s.requireAll)return u}else{if(e(d))continue;{const e=o.getValues(i,d)[0];let a=!1;if(e&&(p([e]),a="@default"in e),l=!1,0===f.length&&a)continue;if(f.length>0&&h)return!1;if(void 0===e){if(f.length>0)return!1;u=!0}else if(t.isList(e)){const n=e["@list"][0];if(t.isList(f[0])){const e=f[0]["@list"];t.isValue(n)?u=e.some((e=>m(n,e))):(t.isSubject(n)||t.isSubjectReference(n))&&(u=e.some((e=>y(r,n,e,s))))}}else u=t.isValue(e)?f.some((t=>m(e,t))):t.isSubjectReference(e)?f.some((t=>y(r,e,t,s))):!!n.isObject(e)&&f.length>0}}if(!u&&s.requireAll)return!1;c=c||u}return l||c}function h(e,t){const r=e.uniqueEmbeds[e.graph],a=r[t],i=a.parent,s=a.property,l={"@id":t};if(n.isArray(i)){for(let e=0;e<i.length;++e)if(o.compareValues(i[e],l)){i[e]=l;break}}else{const e=n.isArray(i[s]);o.removeValue(i,s,l,{propertyIsArray:e}),o.addValue(i,s,l,{propertyIsArray:e})}const c=e=>{const t=Object.keys(r);for(const o of t)o in r&&n.isObject(r[o].parent)&&r[o].parent["@id"]===e&&(delete r[o],c(o))};c(t)}
/**
	 * Removes the @preserve keywords from expanded result of framing.
	 *
	 * @param input the framed, framed output.
	 * @param options the framing options used.
	 *
	 * @return the resulting output.
	 */function v(e,o){if(n.isArray(e))return e.map((e=>v(e,o)));if(n.isObject(e)){
// remove @preserve
if("@preserve"in e)return e["@preserve"][0];if(t.isValue(e))return e;if(t.isList(e))return e["@list"]=v(e["@list"],o),e;if("@id"in e){const t=e["@id"];if(o.link.hasOwnProperty(t)){const n=o.link[t].indexOf(e);if(-1!==n)return o.link[t][n];o.link[t].push(e)}else o.link[t]=[e]}for(const t in e)"@id"===t&&o.bnodesToClear.includes(e[t])?delete e["@id"]:e[t]=v(e[t],o)}return e}function g(e,t,r){n.isObject(e)?o.addValue(e,t,r,{propertyIsArray:!0}):e.push(r)}function y(e,t,n,o){if(!("@id"in n))return!1;const r=e.subjects[n["@id"]];return r&&f(e,r,t,o)}function m(e,t){const o=t["@value"],r=t["@type"],a=t["@language"],i=e["@value"]?n.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],s=e["@type"]?n.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],l=e["@language"]?n.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===i.length&&0===s.length&&0===l.length||!(!i.includes(o)&&!n.isEmptyObject(i[0]))&&(!!(!r&&0===s.length||s.includes(r)||r&&n.isEmptyObject(s[0]))&&!!(!a&&0===l.length||l.includes(a)||a&&n.isEmptyObject(l[0])))}return Ee=l,l.frameMergedOrDefault=(e,t,n)=>{const r={options:n,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},a=new o.IdentifierIssuer("_:b");i(e,r.graphMap,"@default",a),n.merged&&(r.graphMap["@merged"]=s(r.graphMap),r.graph="@merged"),r.subjects=r.graphMap[r.graph];const c=[];return l.frame(r,Object.keys(r.subjects).sort(),t,c),n.pruneBlankNodeIdentifiers&&(n.bnodesToClear=Object.keys(r.bnodeMap).filter((e=>1===r.bnodeMap[e].length))),
// remove @preserve from results
n.link={},v(c,n)},l.frame=(r,i,s,v,y=null)=>{p(s),s=s[0];const x=r.options,b={embed:u(s,x,"embed"),explicit:u(s,x,"explicit"),requireAll:u(s,x,"requireAll")};r.link.hasOwnProperty(r.graph)||(r.link[r.graph]={});const w=r.link[r.graph],j=function(e,t,n,o){const r={};for(const a of t){const t=e.graphMap[e.graph][a];f(e,t,n,o)&&(r[a]=t)}return r}(r,i,s,b),I=Object.keys(j).sort();for(const p of I){const f=j[p];if(null===y?r.uniqueEmbeds={[r.graph]:{}}:r.uniqueEmbeds[r.graph]=r.uniqueEmbeds[r.graph]||{},"@link"===b.embed&&p in w){g(v,y,w[p]);continue}const I={"@id":p};if(0===p.indexOf("_:")&&o.addValue(r.bnodeMap,p,I,{propertyIsArray:!0}),w[p]=I,("@first"===b.embed||"@last"===b.embed)&&r.is11)throw new a("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:s});if(r.embedded||!r.uniqueEmbeds[r.graph].hasOwnProperty(p))if(!r.embedded||"@never"!==b.embed&&!d(f,r.graph,r.subjectStack))if(!r.embedded||"@first"!=b.embed&&"@once"!=b.embed||!r.uniqueEmbeds[r.graph].hasOwnProperty(p)){if("@last"===b.embed&&p in r.uniqueEmbeds[r.graph]&&h(r,p),r.uniqueEmbeds[r.graph][p]={parent:v,property:y},r.subjectStack.push({subject:f,graph:r.graph}),p in r.graphMap){let e=!1,t=null;"@graph"in s?(t=s["@graph"][0],e=!("@merged"===p||"@default"===p),n.isObject(t)||(t={})):(e="@merged"!==r.graph,t={}),e&&l.frame({...r,graph:p,embedded:!1},Object.keys(r.graphMap[p]).sort(),[t],I,"@graph")}"@included"in s&&l.frame({...r,embedded:!1},i,s["@included"],I,"@included");for(const n of Object.keys(f).sort())if(e(n)){if(I[n]=o.clone(f[n]),"@type"===n)for(const e of f["@type"])0===e.indexOf("_:")&&o.addValue(r.bnodeMap,e,I,{propertyIsArray:!0})}else if(!b.explicit||n in s)for(const e of f[n]){const a=n in s?s[n]:c(b);if(t.isList(e)){const a=s[n]&&s[n][0]&&s[n][0]["@list"]?s[n][0]["@list"]:c(b),i={"@list":[]};g(I,n,i);const d=e["@list"];for(const e of d)t.isSubjectReference(e)?l.frame({...r,embedded:!0},[e["@id"]],a,i,"@list"):g(i,"@list",o.clone(e))}else t.isSubjectReference(e)?l.frame({...r,embedded:!0},[e["@id"]],a,I,n):m(a[0],e)&&g(I,n,o.clone(e))}for(const t of Object.keys(s).sort()){if("@type"===t){if(!n.isObject(s[t][0])||!("@default"in s[t][0]))continue}else if(e(t))continue;const r=s[t][0]||{};if(!u(r,x,"omitDefault")&&!(t in I)){let e="@null";"@default"in r&&(e=o.clone(r["@default"])),n.isArray(e)||(e=[e]),I[t]=[{"@preserve":e}]}}for(const e of Object.keys(s["@reverse"]||{}).sort()){const t=s["@reverse"][e];for(const n of Object.keys(r.subjects)){o.getValues(r.subjects[n],e).some((e=>e["@id"]===p))&&(I["@reverse"]=I["@reverse"]||{},o.addValue(I["@reverse"],e,[],{propertyIsArray:!0}),l.frame({...r,embedded:!0},[n],t,I["@reverse"][e],y))}}g(v,y,I),r.subjectStack.pop()}else g(v,y,I);else g(v,y,I)}},l.cleanupNull=(e,t)=>{if(n.isArray(e)){return e.map((e=>l.cleanupNull(e,t))).filter((e=>e))}if("@null"===e)return null;if(n.isObject(e)){if("@id"in e){const n=e["@id"];if(t.link.hasOwnProperty(n)){const o=t.link[n].indexOf(e);if(-1!==o)return t.link[n][o];t.link[n].push(e)}else t.link[n]=[e]}for(const n in e)e[n]=l.cleanupNull(e[n],t)}return e},Ee}function nt(){if(Ce)return ke;Ce=1;const e=Be(),{isArray:t,isObject:n,isString:o,isUndefined:r}=Je(),{isList:a,isValue:i,isGraph:s,isSimpleGraph:l,isSubjectReference:c}=Pe(),{expandIri:d,getContextValue:u,isKeyword:p,process:f,processingMode:h}=We(),{removeBase:v,prependBase:g}=Ue(),{REGEX_KEYWORD:y,addValue:m,asArray:x,compareShortestLeast:b}=He(),w={};function j(t,n,o){if("@nest"!==d(t,n,{vocab:!0},o))throw new e("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}return ke=w,w.compact=async({activeCtx:d,activeProperty:v=null,element:g,options:y={}})=>{if(t(g)){let e=[];for(let t=0;t<g.length;++t){const n=await w.compact({activeCtx:d,activeProperty:v,element:g[t],options:y});null!==n&&e.push(n)}if(y.compactArrays&&1===e.length){0===(u(d,v,"@container")||[]).length&&(e=e[0])}return e}const b=u(d,v,"@context");if(r(b)||(d=await f({activeCtx:d,localCtx:b,propagate:!0,overrideProtected:!0,options:y})),n(g)){if(y.link&&"@id"in g&&y.link.hasOwnProperty(g["@id"])){const e=y.link[g["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===g)return e[t].compacted}if(i(g)||c(g)){const e=w.compactValue({activeCtx:d,activeProperty:v,value:g,options:y});return y.link&&c(g)&&(y.link.hasOwnProperty(g["@id"])||(y.link[g["@id"]]=[]),y.link[g["@id"]].push({expanded:g,compacted:e})),e}if(a(g)){if((u(d,v,"@container")||[]).includes("@list"))return w.compact({activeCtx:d,activeProperty:v,element:g["@list"],options:y})}const b="@reverse"===v,I={},N=d;i(g)||c(g)||(d=d.revertToPreviousContext());const S=u(N,v,"@context");r(S)||(d=await f({activeCtx:d,localCtx:S,propagate:!0,overrideProtected:!0,options:y})),y.link&&"@id"in g&&(y.link.hasOwnProperty(g["@id"])||(y.link[g["@id"]]=[]),y.link[g["@id"]].push({expanded:g,compacted:I}));let O=g["@type"]||[];O.length>1&&(O=Array.from(O).sort());const E=d;for(const e of O){const t=w.compactIri({activeCtx:E,iri:e,relativeTo:{vocab:!0}}),n=u(N,t,"@context");r(n)||(d=await f({activeCtx:d,localCtx:n,options:y,propagate:!1}))}const D=Object.keys(g).sort();for(const r of D){const c=g[r];if("@id"!==r)if("@type"!==r)if("@reverse"!==r)if("@preserve"!==r)if("@index"!==r)if("@graph"!==r&&"@list"!==r&&"@included"!==r&&p(r)){const e=w.compactIri({activeCtx:d,iri:r,relativeTo:{vocab:!0}});m(I,e,c)}else{if(!t(c))throw new e("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===c.length){const e=w.compactIri({activeCtx:d,iri:r,value:c,relativeTo:{vocab:!0},reverse:b}),t=d.mappings.has(e)?d.mappings.get(e)["@nest"]:null;let o=I;t&&(j(d,t,y),n(I[t])||(I[t]={}),o=I[t]),m(o,e,c,{propertyIsArray:!0})}for(const e of c){const c=w.compactIri({activeCtx:d,iri:r,value:e,relativeTo:{vocab:!0},reverse:b}),p=d.mappings.has(c)?d.mappings.get(c)["@nest"]:null;let f=I;p&&(j(d,p,y),n(I[p])||(I[p]={}),f=I[p]);const h=u(d,c,"@container")||[],v=s(e),g=a(e);let N;g?N=e["@list"]:v&&(N=e["@graph"]);let S=await w.compact({activeCtx:d,activeProperty:c,element:g||v?N:e,options:y});if(g){if(t(S)||(S=[S]),h.includes("@list")){m(f,c,S,{valueIsArray:!0,allowDuplicate:!0});continue}S={[w.compactIri({activeCtx:d,iri:"@list",relativeTo:{vocab:!0}})]:S},"@index"in e&&(S[w.compactIri({activeCtx:d,iri:"@index",relativeTo:{vocab:!0}})]=e["@index"])}if(v)if(h.includes("@graph")&&(h.includes("@id")||h.includes("@index")&&l(e))){let t;f.hasOwnProperty(c)?t=f[c]:f[c]=t={};const n=(h.includes("@id")?e["@id"]:e["@index"])||w.compactIri({activeCtx:d,iri:"@none",relativeTo:{vocab:!0}});m(t,n,S,{propertyIsArray:!y.compactArrays||h.includes("@set")})}else h.includes("@graph")&&l(e)?(t(S)&&S.length>1&&(S={"@included":S}),m(f,c,S,{propertyIsArray:!y.compactArrays||h.includes("@set")})):(t(S)&&1===S.length&&y.compactArrays&&(S=S[0]),S={[w.compactIri({activeCtx:d,iri:"@graph",relativeTo:{vocab:!0}})]:S},"@id"in e&&(S[w.compactIri({activeCtx:d,iri:"@id",relativeTo:{vocab:!0}})]=e["@id"]),"@index"in e&&(S[w.compactIri({activeCtx:d,iri:"@index",relativeTo:{vocab:!0}})]=e["@index"]),m(f,c,S,{propertyIsArray:!y.compactArrays||h.includes("@set")}));else if(h.includes("@language")||h.includes("@index")||h.includes("@id")||h.includes("@type")){let t,n;if(f.hasOwnProperty(c)?t=f[c]:f[c]=t={},h.includes("@language"))i(S)&&(S=S["@value"]),n=e["@language"];else if(h.includes("@index")){const t=u(d,c,"@index")||"@index",r=w.compactIri({activeCtx:d,iri:t,relativeTo:{vocab:!0}});if("@index"===t)n=e["@index"],delete S[r];else{let e;if([n,...e]=x(S[t]||[]),o(n))switch(e.length){case 0:delete S[t];break;case 1:S[t]=e[0];break;default:S[t]=e}else n=null}}else if(h.includes("@id")){const e=w.compactIri({activeCtx:d,iri:"@id",relativeTo:{vocab:!0}});n=S[e],delete S[e]}else if(h.includes("@type")){const t=w.compactIri({activeCtx:d,iri:"@type",relativeTo:{vocab:!0}});let o;switch([n,...o]=x(S[t]||[]),o.length){case 0:delete S[t];break;case 1:S[t]=o[0];break;default:S[t]=o}1===Object.keys(S).length&&"@id"in e&&(S=await w.compact({activeCtx:d,activeProperty:c,element:{"@id":e["@id"]},options:y}))}n||(n=w.compactIri({activeCtx:d,iri:"@none",relativeTo:{vocab:!0}})),m(t,n,S,{propertyIsArray:h.includes("@set")})}else{const e=!y.compactArrays||h.includes("@set")||h.includes("@list")||t(S)&&0===S.length||"@list"===r||"@graph"===r;m(f,c,S,{propertyIsArray:e})}}}else{if((u(d,v,"@container")||[]).includes("@index"))continue;const e=w.compactIri({activeCtx:d,iri:r,relativeTo:{vocab:!0}});m(I,e,c)}else{const e=await w.compact({activeCtx:d,activeProperty:v,element:c,options:y});t(e)&&0===e.length||m(I,r,e)}else{const e=await w.compact({activeCtx:d,activeProperty:"@reverse",element:c,options:y});for(const t in e)if(d.mappings.has(t)&&d.mappings.get(t).reverse){const n=e[t],o=(u(d,t,"@container")||[]).includes("@set")||!y.compactArrays;m(I,t,n,{propertyIsArray:o}),delete e[t]}if(Object.keys(e).length>0){const t=w.compactIri({activeCtx:d,iri:r,relativeTo:{vocab:!0}});m(I,t,e)}}else{let e=x(c).map((e=>w.compactIri({activeCtx:N,iri:e,relativeTo:{vocab:!0}})));1===e.length&&(e=e[0]);const n=w.compactIri({activeCtx:d,iri:"@type",relativeTo:{vocab:!0}}),o=(u(d,n,"@container")||[]).includes("@set")&&h(d,1.1)||t(e)&&0===c.length;m(I,n,e,{propertyIsArray:o})}else{let e=x(c).map((e=>w.compactIri({activeCtx:d,iri:e,relativeTo:{vocab:!1},base:y.base})));1===e.length&&(e=e[0]);I[w.compactIri({activeCtx:d,iri:"@id",relativeTo:{vocab:!0}})]=e}}return I}return g},w.compactIri=({activeCtx:t,iri:o,value:r=null,relativeTo:l={vocab:!1},reverse:c=!1,base:d=null})=>{if(null===o)return o;t.isPropertyTermScoped&&t.previousContext&&(t=t.previousContext);const u=t.getInverse();if(p(o)&&o in u&&"@none"in u[o]&&"@type"in u[o]["@none"]&&"@none"in u[o]["@none"]["@type"])return u[o]["@none"]["@type"]["@none"];if(l.vocab&&o in u){const e=t["@language"]||"@none",l=[];n(r)&&"@index"in r&&!("@graph"in r)&&l.push("@index","@index@set"),n(r)&&"@preserve"in r&&(r=r["@preserve"][0]),s(r)?("@index"in r&&l.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r&&l.push("@graph@id","@graph@id@set"),l.push("@graph","@graph@set","@set"),"@index"in r||l.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r||l.push("@graph@id","@graph@id@set")):n(r)&&!i(r)&&l.push("@id","@id@set","@type","@set@type");let d="@language",u="@null";if(c)d="@type",u="@reverse",l.push("@set");else if(a(r)){"@index"in r||l.push("@list");const t=r["@list"];if(0===t.length)d="@any",u="@none";else{let n=0===t.length?e:null,o=null;for(let e=0;e<t.length;++e){const r=t[e];let a="@none",s="@none";if(i(r))if("@direction"in r){a=`${(r["@language"]||"").toLowerCase()}_${r["@direction"]}`}else"@language"in r?a=r["@language"].toLowerCase():"@type"in r?s=r["@type"]:a="@null";else s="@id";if(null===n?n=a:a!==n&&i(r)&&(n="@none"),null===o?o=s:s!==o&&(o="@none"),"@none"===n&&"@none"===o)break}n=n||"@none",o=o||"@none","@none"!==o?(d="@type",u=o):u=n}}else{if(i(r))if("@language"in r&&!("@index"in r)){l.push("@language","@language@set"),u=r["@language"];const e=r["@direction"];e&&(u=`${u}_${e}`)}else"@direction"in r&&!("@index"in r)?u=`_${r["@direction"]}`:"@type"in r&&(d="@type",u=r["@type"]);else d="@type",u="@id";l.push("@set")}l.push("@none"),n(r)&&!("@index"in r)&&l.push("@index","@index@set"),i(r)&&1===Object.keys(r).length&&l.push("@language","@language@set");const p=function(e,t,o,r,a,i){null===i&&(i="@null");const s=[];if(("@id"===i||"@reverse"===i)&&n(o)&&"@id"in o){"@reverse"===i&&s.push("@reverse");const t=w.compactIri({activeCtx:e,iri:o["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===o["@id"]?s.push.apply(s,["@vocab","@id"]):s.push.apply(s,["@id","@vocab"])}else{s.push(i);const e=s.find((e=>e.includes("_")));e&&s.push(e.replace(/^[^_]+_/,"_"))}s.push("@none");const l=e.inverse[t];for(const e of r){if(!(e in l))continue;const t=l[e][a];for(const e of s)if(e in t)return t[e]}return null}(t,o,r,l,d,u);if(null!==p)return p}if(l.vocab&&"@vocab"in t){const e=t["@vocab"];if(0===o.indexOf(e)&&o!==e){const n=o.substr(e.length);if(!t.mappings.has(n))return n}}let f=null;const h=[];let m=t.fastCurieMap;const x=o.length-1;for(let e=0;e<x&&o[e]in m;++e)m=m[o[e]],""in m&&h.push(m[""][0]);for(let e=h.length-1;e>=0;--e){const n=h[e],a=n.terms;for(const e of a){const a=e+":"+o.substr(n.iri.length);t.mappings.get(e)._prefix&&(!t.mappings.has(a)||null===r&&t.mappings.get(a)["@id"]===o)&&(null===f||b(a,f)<0)&&(f=a)}}if(null!==f)return f;for(const[n,r]of t.mappings)if(r&&r._prefix&&o.startsWith(n+":"))throw new e(`Absolute IRI "${o}" confused with prefix "${n}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:t});if(!l.vocab){if("@base"in t){if(t["@base"]){const e=v(g(d,t["@base"]),o);return y.test(e)?`./${e}`:e}return o}return v(d,o)}return o},w.compactValue=({activeCtx:e,activeProperty:t,value:n,options:r})=>{if(i(n)){const r=u(e,t,"@type"),a=u(e,t,"@language"),i=u(e,t,"@direction"),s=u(e,t,"@container")||[],l="@index"in n&&!s.includes("@index");if(!l&&"@none"!==r){if(n["@type"]===r)return n["@value"];if("@language"in n&&n["@language"]===a&&"@direction"in n&&n["@direction"]===i)return n["@value"];if("@language"in n&&n["@language"]===a)return n["@value"];if("@direction"in n&&n["@direction"]===i)return n["@value"]}const c=Object.keys(n).length,d=1===c||2===c&&"@index"in n&&!l,p="@language"in e,f=o(n["@value"]),h=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(d&&"@none"!==r&&(!p||!f||h))return n["@value"];const v={};return l&&(v[w.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=n["@index"]),"@type"in n?v[w.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=w.compactIri({activeCtx:e,iri:n["@type"],relativeTo:{vocab:!0}}):"@language"in n&&(v[w.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=n["@language"]),"@direction"in n&&(v[w.compactIri({activeCtx:e,iri:"@direction",relativeTo:{vocab:!0}})]=n["@direction"]),v[w.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=n["@value"],v}const a=d(e,t,{vocab:!0},r),s=u(e,t,"@type"),l=w.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:"@vocab"===s},base:r.base});return"@id"===s||"@vocab"===s||"@graph"===a?l:{[w.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:l}},ke}function ot(){if(Ae)return Te;Ae=1;const e=Me(),t=function(){if(Z)return K;Z=1;const e=Ve(),t={};return K=t,t.setupDocumentLoaders=function(t){"undefined"!=typeof XMLHttpRequest&&(t.documentLoaders.xhr=e,t.useDocumentLoader("xhr"))},t.setupGlobals=function(e){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor})},K}(),n=He(),o=$e(),r=n.IdentifierIssuer,a=Be(),i=Ge(),s=Qe(),{expand:l}=Ke(),{flatten:c}=function(){if(be)return xe;be=1;const{isSubjectReference:e}=Pe(),{createMergedNodeMap:t}=Ze(),n={};return xe=n,n.flatten=n=>{const o=t(n),r=[],a=Object.keys(o).sort();for(let t=0;t<a.length;++t){const n=o[a[t]];e(n)||r.push(n)}return r},xe}(),{fromRDF:d}=function(){if(je)return we;je=1;const e=Be(),t=Pe(),n=Je(),{REGEX_BCP47:o,addValue:r}=He(),{handleEvent:a}=Xe(),{RDF_LIST:i,RDF_FIRST:s,RDF_REST:l,RDF_NIL:c,RDF_TYPE:d,RDF_JSON_LITERAL:u,XSD_BOOLEAN:p,XSD_DOUBLE:f,XSD_INTEGER:h,XSD_STRING:v}=Fe(),g={};function y(t,r,i,s){if(t.termType.endsWith("Node"))return{"@id":t.value};const l={"@value":t.value};if(t.language)t.language.match(o)||s.eventHandler&&a({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:t.language}},options:s}),l["@language"]=t.language;else{let c=t.datatype.value;if(c||(c=v),c===u){c="@json";try{l["@value"]=JSON.parse(l["@value"])}catch(t){throw new e("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:l["@value"],cause:t})}}if(r){if(c===p)"true"===l["@value"]?l["@value"]=!0:"false"===l["@value"]&&(l["@value"]=!1);else if(n.isNumeric(l["@value"]))if(c===h){const e=parseInt(l["@value"],10);e.toFixed(0)===l["@value"]&&(l["@value"]=e)}else c===f&&(l["@value"]=parseFloat(l["@value"]));[p,h,f,v].includes(c)||(l["@type"]=c)}else if("i18n-datatype"===i&&c.startsWith("https://www.w3.org/ns/i18n#")){const[,e,t]=c.split(/[#_]/);e.length>0&&(l["@language"]=e,e.match(o)||s.eventHandler&&a({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:s})),l["@direction"]=t}else c!==v&&(l["@type"]=c)}return l}return we=g,g.fromRDF=async(o,a)=>{const{useRdfType:u=!1,useNativeTypes:p=!1,rdfDirection:f=null}=a,h={},v={"@default":h},g={};if(f){if("compound-literal"===f)throw new e("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:f});if("i18n-datatype"!==f)throw new e("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:f})}for(const e of o){const t="DefaultGraph"===e.graph.termType?"@default":e.graph.value;t in v||(v[t]={}),"@default"===t||t in h||(h[t]={"@id":t});const n=v[t],o=e.subject.value,i=e.predicate.value,s=e.object;o in n||(n[o]={"@id":o});const l=n[o],m=s.termType.endsWith("Node");if(m&&!(s.value in n)&&(n[s.value]={"@id":s.value}),i===d&&!u&&m){r(l,"@type",s.value,{propertyIsArray:!0});continue}const x=y(s,p,f,a);if(r(l,i,x,{propertyIsArray:!0}),m)if(s.value===c){const e=n[s.value];"usages"in e||(e.usages=[]),e.usages.push({node:l,property:i,value:x})}else s.value in g?g[s.value]=!1:g[s.value]={node:l,property:i,value:x}}for(const e in v){const o=v[e];if(!(c in o))continue;const r=o[c];if(r.usages){for(let e of r.usages){let r=e.node,a=e.property,c=e.value;const d=[],u=[];let p=Object.keys(r).length;for(;a===l&&n.isObject(g[r["@id"]])&&n.isArray(r[s])&&1===r[s].length&&n.isArray(r[l])&&1===r[l].length&&(3===p||4===p&&n.isArray(r["@type"])&&1===r["@type"].length&&r["@type"][0]===i)&&(d.push(r[s][0]),u.push(r["@id"]),e=g[r["@id"]],r=e.node,a=e.property,c=e.value,p=Object.keys(r).length,t.isBlankNode(r)););delete c["@id"],c["@list"]=d.reverse();for(const e of u)delete o[e]}delete r.usages}}const m=[],x=Object.keys(h).sort();for(const e of x){const n=h[e];if(e in v){const o=n["@graph"]=[],r=v[e],a=Object.keys(r).sort();for(const e of a){const n=r[e];t.isSubjectReference(n)||o.push(n)}}t.isSubjectReference(n)||m.push(n)}return m},we}(),{toRDF:u}=et(),{frameMergedOrDefault:p,cleanupNull:f}=tt(),{isArray:h,isObject:v,isString:g}=Je(),{isSubjectReference:y}=Pe(),{expandIri:m,getInitialContext:x,process:b,processingMode:w}=We(),{compact:j,compactIri:I}=nt(),{createNodeMap:N,createMergedNodeMap:S,mergeNodeMaps:O}=Ze(),{logEventHandler:E,logWarningEventHandler:D,safeEventHandler:k,setDefaultEventHandler:C,setupEventHandler:L,strictEventHandler:R,unhandledEventHandler:T}=Xe(),A=function(A){const _={},M=new i({max:100});function J(e,{documentLoader:t=A.documentLoader,...n}){if(e&&"compactionMap"in e)throw new a('"compactionMap" not supported.',"jsonld.OptionsError");if(e&&"expansionMap"in e)throw new a('"expansionMap" not supported.',"jsonld.OptionsError");return Object.assign({},{documentLoader:t},n,e,{eventHandler:L({options:e})})}return A.compact=async function(e,t,i){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===t)throw new a("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===e)return null;let s;(i=J(i,{base:g(e)?e:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new r("_:b"),contextResolver:new o({sharedCache:M})})).link&&(i.skipExpansion=!0),i.compactToRelative||delete i.base,s=i.skipExpansion?e:await A.expand(e,i);const l=await A.processContext(x(i),t,i);let c=await j({activeCtx:l,element:s,options:i});i.compactArrays&&!i.graph&&h(c)?1===c.length?c=c[0]:0===c.length&&(c={}):i.graph&&v(c)&&(c=[c]),v(t)&&"@context"in t&&(t=t["@context"]),t=n.clone(t),h(t)||(t=[t]);const d=t;t=[];for(let e=0;e<d.length;++e)(!v(d[e])||Object.keys(d[e]).length>0)&&t.push(d[e]);const u=t.length>0;if(1===t.length&&(t=t[0]),h(c)){const e=I({activeCtx:l,iri:"@graph",relativeTo:{vocab:!0}}),n=c;c={},u&&(c["@context"]=t),c[e]=n}else if(v(c)&&u){const e=c;c={"@context":t};for(const t in e)c[t]=e[t]}return c},A.expand=async function(e,t){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");const r={},a=[];if("expandContext"in(t=J(t,{keepFreeFloatingNodes:!1,contextResolver:new o({sharedCache:M})}))){const e=n.clone(t.expandContext);v(e)&&"@context"in e?r.expandContext=e:r.expandContext={"@context":e},a.push(r.expandContext)}let i;if(g(e)){const n=await A.get(e,t);i=n.documentUrl,r.input=n.document,n.contextUrl&&(r.remoteContext={"@context":n.contextUrl},a.push(r.remoteContext))}else r.input=n.clone(e);"base"in t||(t.base=i||"");let s=x(t);for(const e of a)s=await b({activeCtx:s,localCtx:e,options:t});let c=await l({activeCtx:s,element:r.input,options:t});return v(c)&&"@graph"in c&&1===Object.keys(c).length?c=c["@graph"]:null===c&&(c=[]),h(c)||(c=[c]),c},A.flatten=async function(e,t,n){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");t="function"==typeof t?null:t||null,n=J(n,{base:g(e)?e:"",contextResolver:new o({sharedCache:M})});const r=await A.expand(e,n),a=c(r);if(null===t)return a;n.graph=!0,n.skipExpansion=!0;return await A.compact(a,t,n)},A.frame=async function(e,t,n){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(n=J(n,{base:g(e)?e:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new o({sharedCache:M})}),g(t)){const e=await A.get(t,n);if(t=e.document,e.contextUrl){let n=t["@context"];n?h(n)?n.push(e.contextUrl):n=[n,e.contextUrl]:n=e.contextUrl,t["@context"]=n}}const r=t&&t["@context"]||{},a=await A.processContext(x(n),r,n);n.hasOwnProperty("omitGraph")||(n.omitGraph=w(a,1.1)),n.hasOwnProperty("pruneBlankNodeIdentifiers")||(n.pruneBlankNodeIdentifiers=w(a,1.1));const i=await A.expand(e,n),s={...n};s.isFrame=!0,s.keepFreeFloatingNodes=!0;const l=await A.expand(t,s),c=Object.keys(t).map((e=>m(a,e,{vocab:!0})));s.merged=!c.includes("@graph"),s.is11=w(a,1.1);const d=p(i,l,s);s.graph=!n.omitGraph,s.skipExpansion=!0,s.link={},s.framing=!0;let u=await A.compact(d,r,s);return s.link={},u=f(u,s),u},A.link=async function(e,t,n){const o={};return t&&(o["@context"]=t),o["@embed"]="@link",A.frame(e,o,n)},A.normalize=A.canonize=async function(t,n){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(n=J(n,{base:g(t)?t:null,algorithm:"URDNA2015",skipExpansion:!1,safe:!0,contextResolver:new o({sharedCache:M})}))){if("application/n-quads"!==n.inputFormat&&"application/nquads"!==n.inputFormat)throw new a("Unknown canonicalization input format.","jsonld.CanonizeError");const o=s.parse(t);return e.canonize(o,n)}const r={...n};delete r.format,r.produceGeneralizedRdf=!1;const i=await A.toRDF(t,r);return e.canonize(i,n)},A.fromRDF=async function(e,t){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");t=J(t,{format:g(e)?"application/n-quads":void 0});const{format:n}=t;let{rdfParser:o}=t;if(n){if(o=o||_[n],!o)throw new a("Unknown input format.","jsonld.UnknownFormat",{format:n})}else o=()=>e;const r=await o(e);return d(r,t)},A.toRDF=async function(e,t){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let n;n=(t=J(t,{base:g(e)?e:"",skipExpansion:!1,contextResolver:new o({sharedCache:M})})).skipExpansion?e:await A.expand(e,t);const r=u(n,t);if(t.format){if("application/n-quads"===t.format||"application/nquads"===t.format)return s.serialize(r);throw new a("Unknown output format.","jsonld.UnknownFormat",{format:t.format})}return r},A.createNodeMap=async function(e,t){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");t=J(t,{base:g(e)?e:"",contextResolver:new o({sharedCache:M})});const n=await A.expand(e,t);return S(n,t)},A.merge=async function(e,t,a){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!h(e))throw new TypeError('Could not merge, "docs" must be an array.');t="function"==typeof t?null:t||null,a=J(a,{contextResolver:new o({sharedCache:M})});const i=await Promise.all(e.map((e=>{const t={...a};return A.expand(e,t)})));let s=!0;"mergeNodes"in a&&(s=a.mergeNodes);const l=a.issuer||new r("_:b"),c={"@default":{}};for(let e=0;e<i.length;++e){const t=n.relabelBlankNodes(i[e],{issuer:new r("_:b"+e+"-")}),o=s||0===e?c:{"@default":{}};if(N(t,o,"@default",l),o!==c)for(const e in o){const t=o[e];if(!(e in c)){c[e]=t;continue}const n=c[e];for(const e in t)e in n||(n[e]=t[e])}}const d=O(c),u=[],p=Object.keys(d).sort();for(let e=0;e<p.length;++e){const t=d[p[e]];y(t)||u.push(t)}if(null===t)return u;a.graph=!0,a.skipExpansion=!0;return await A.compact(u,t,a)},Object.defineProperty(A,"documentLoader",{get:()=>A._documentLoader,set:e=>A._documentLoader=e}),A.documentLoader=async e=>{throw new a("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})},A.get=async function(e,t){let n;n="function"==typeof t.documentLoader?t.documentLoader:A.documentLoader;const o=await n(e);try{if(!o.document)throw new a("No remote document found at the given URL.","jsonld.NullRemoteDocument");g(o.document)&&(o.document=JSON.parse(o.document))}catch(e){throw new a("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:o})}return o},A.processContext=async function(e,t,r){return r=J(r,{base:"",contextResolver:new o({sharedCache:M})}),null===t?x(r):(t=n.clone(t),v(t)&&"@context"in t||(t={"@context":t}),b({activeCtx:e,localCtx:t,options:r}))},A.getContextValue=We().getContextValue,A.documentLoaders={},A.useDocumentLoader=function(e){if(!(e in A.documentLoaders))throw new a('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});A.documentLoader=A.documentLoaders[e].apply(A,Array.prototype.slice.call(arguments,1))},A.registerRDFParser=function(e,t){_[e]=t},A.unregisterRDFParser=function(e){delete _[e]},A.registerRDFParser("application/n-quads",s.parse),A.registerRDFParser("application/nquads",s.parse),A.url=Ue(),A.logEventHandler=E,A.logWarningEventHandler=D,A.safeEventHandler=k,A.setDefaultEventHandler=C,A.strictEventHandler=R,A.unhandledEventHandler=T,A.util=n,Object.assign(A,n),A.promises=A,A.RequestQueue=qe(),A.JsonLdProcessor=(Re||(Re=1,Le=e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,n){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,n)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t}),Le)(A),t.setupGlobals(A),t.setupDocumentLoaders(A),A},_=function(){return A((function(){return _()}))};return A(_),Te=_}var rt=e(ot());export{ot as a,_e as b,N as c,rt as j,Ye as r};
