import{V as t,A as e,d as n,C as i,D as o,E as s,F as r}from"./main.js";import{e as a,d as c}from"./base64url-Cy03LJLt-vkTPfQOh.js";import{g as u,u as d}from"./pako.esm-DnD5dZGi-HambcU-w.js";
/*!
 * Copyright (c) 2020 Digital Bazaar, Inc. All rights reserved.
 */function f(t,e){if("number"!=typeof t)throw new TypeError(`"${e}" must be number.`)}function h(t,e){if(!(Number.isInteger(t)&&t>0))throw new TypeError(`"${e}" must be a positive integer.`)}function g(t,e){if("boolean"!=typeof t)throw new TypeError(`"${e}" must be a boolean.`)}function l(t,e){if(!(t instanceof Uint8Array))throw new TypeError(`"${e}" must be a Uint8Array.`)}
/*!
 * Copyright (c) 2020-2023 Digital Bazaar, Inc. All rights reserved.
 */class b{constructor({length:t,buffer:e,leftToRightIndexing:n,littleEndianBits:i}={}){if(t&&e)throw new Error('Only one of "length" or "buffer" must be given.');if(void 0!==t?h(t,"length"):l(e,"buffer"),void 0!==i){if(void 0!==n)throw new Error('Using both "littleEndianBits" and "leftToRightIndexing" is not allowed.');g(i,"littleEndianBits"),n=i}void 0===n?n=!0:g(n,"leftToRightIndexing"),t?(this.bits=new Uint8Array(Math.ceil(t/8)),this.length=t):(this.bits=new Uint8Array(e.buffer),this.length=8*e.length),this.leftToRightIndexing=n}set(t,e){f(t,"position"),g(e,"on");const{length:n,leftToRightIndexing:i}=this,{index:o,bit:s}=w(t,n,i);e?this.bits[o]|=s:this.bits[o]&=255^s}get(t){f(t,"position");const{length:e,leftToRightIndexing:n}=this,{index:i,bit:o}=w(t,e,n);return!!(this.bits[i]&o)}async encodeBits(){return a(u(this.bits))}static async decodeBits({encoded:t}){return function(t,e){if("string"!=typeof t)throw new TypeError(`"${e}" must be a string.`)}(t,"encoded"),d(c(t))}async compressBits(){return u(this.bits)}static async uncompressBits({compressed:t}){return l(t,"compressed"),d(t)}}function w(t,e,n){if(function(t,e){if(!(Number.isInteger(t)&&t>=0))throw new TypeError(`"${e}" must be a non-negative integer.`)}(t,"position"),h(e,"length"),g(n,"leftToRightIndexing"),t>=e)throw new Error(`Position "${t}" is out of range "0-${e-1}".`);const i=t%8;return{index:Math.floor(t/8),bit:1<<(n?7-i:i)}}
/*!
 * Copyright (c) 2020-2022 Digital Bazaar, Inc. All rights reserved.
 */class y{constructor({length:t,buffer:e}={}){this.bitstring=new b({length:t,buffer:e}),this.length=this.bitstring.length}setRevoked(t,e){if("boolean"!=typeof e)throw new TypeError('"revoked" must be a boolean.');return this.bitstring.set(t,e)}isRevoked(t){return this.bitstring.get(t)}async encode(){return this.bitstring.encodeBits()}static async decode({encodedList:t}){const e=await b.decodeBits({encoded:t});return new y({buffer:e})}}
/*!
 * Copyright (c) 2020-2022 Digital Bazaar, Inc. All rights reserved.
 */async function p({encodedList:t}){return y.decode({encodedList:t})}async function m(i){const s=await o({url:i});if(s)try{return JSON.parse(s)}catch(o){throw console.error(o),new t(e.checkRevokedStatus,`${n.i18n.getText("revocation","noRevocationStatusList2021Found")} ${i}`)}return s}async function v(i){const o=new s(i);await o.init();if((await o.verify()).status===r.FAILURE)throw new t(e.checkRevokedStatus,n.i18n.getText("revocation","revocationListAuthenticityFailure"))}async function R(o){Array.isArray(o)||(o=[o]);for(const s of o){const o=parseInt(s.statusListIndex,10),r=await m(s.statusListCredential);if(!r)throw new t(e.checkRevokedStatus,`${n.i18n.getText("revocation","noRevocationStatusList2021Found")} ${s.statusListCredential}.`);await v(r);const{encodedList:a}=r.credentialSubject;if((await p({encodedList:a})).isRevoked(o)){const o="revocation"===s.statusPurpose?i.REVOKED:i.SUSPENDED;throw new t(e.checkRevokedStatus,n.certificates.generateRevocationReason("",o))}}}export{R as default};
